!function(n){function handleSubmitAutocompleteForm(e){e.preventDefault();var t=c.val();if(""!==t)if(c.autocomplete("close"),19==__flex_g_settings.boardId){for(var o=0,l=u.length;o<l;o++){var n=u[o];if(!1!==new RegExp("^"+n.label+"$","i").test(t)){a=n;break}}void 0!==a?handleRedirectTo(a.label,"city"):handleRedirectTo(t,null)}else if(/^\d+$/.test(t)&&5===t.length)handleRedirectTo(t,"zip");else{for(var a,o=0,l=u.length;o<l;o++){n=u[o];if(!1!==new RegExp("^"+n.label+"$","i").test(t)){a=n;break}}void 0!==a?handleRedirectTo(a.label,"city"):handleRedirectTo(t,null)}}function handleLookupAutocomplete(e,t){var o=e.term;o in l?t(l[o]):n.ajax({url:__flex_g_settings.suggestions.service_url,dataType:"json",data:{term:e.term,board:__flex_g_settings.boardId},success:function(e){l[o]=e,t(e)}})}function handleRedirectTo(e,t){var o=n("#flex_ac_rental_slug").val(),l="undefined"!=typeof IB_AGENT_PERMALINK?IB_AGENT_PERMALINK+"/search":__flex_g_settings.searchUrl,l=(l+="?for="+(0==o?"sale":"rent"))+(null!==t?"&keyword="+encodeURIComponent(e)+"_"+t.toLowerCase():"&keyword="+encodeURIComponent(e));window.location.href=l}function handleSelectAutocomplete(e,t){handleRedirectTo(t.item.value,t.item.type),setTimeout(function(){document.activeElement.blur()},100)}function handleBlurAutocompleteEvent(){}function handleFocusAutocompleteEvent(){""===this.value&&(c.autocomplete("option","source",u),c.autocomplete("search",""))}function handleKeyPressAutocompleteEvent(e){""!==this.value&&13===e.keyCode&&(c.autocomplete("close"),setTimeout(function(){document.activeElement.blur()},100)),c.autocomplete("option","source",handleLookupAutocomplete)}function handleKeyUpAutocompleteEvent(e){if(40!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&37!=e.keyCode){var t=this.value;if(""!==t&&13===e.keyCode)if(c.autocomplete("close"),setTimeout(function(){document.activeElement.blur()},100),19==__flex_g_settings.boardId){for(var o=0,l=u.length;o<l;o++){var n=u[o];if(!1!==new RegExp("^"+n.label+"$","i").test(t)){a=n;break}}void 0!==a?handleRedirectTo(a.label,"city"):handleRedirectTo(t,null)}else if(/^\d+$/.test(t)&&5===t.length)handleRedirectTo(t,"zip");else{for(var a,o=0,l=u.length;o<l;o++){n=u[o];if(!1!==new RegExp("^"+n.label+"$","i").test(t)){a=n;break}}void 0!==a?handleRedirectTo(a.label,"city"):handleRedirectTo(t,null)}""===t?(c.autocomplete("option","source",u),c.autocomplete("search","")):(c.autocomplete("option","source",handleLookupAutocomplete),c.autocomplete("search",c.val()))}}function handleClearAutocompleteEvent(){c.autocomplete("option","source",u),c.autocomplete("search","")}function handlePasteAutocompleteEvent(){c.autocomplete("option","source",handleLookupAutocomplete)}var c,e,u=function ib_fetch_default_cities(){var e=_.pluck(__flex_g_settings.params.cities,"name"),t=[];if(e.length)for(var o=0,l=e.length;o<l;o++)t.push({label:e[o],type:"city"});return t}(),l={};n(function(){c=n("#flex_idx_single_autocomplete_input"),(e=n("#flex_idx_single_autocomplete")).length&&e.on("submit",handleSubmitAutocompleteForm),c.length&&(c.autocomplete({minLength:0,open:function(e,t){n(".ui-autocomplete").off("menufocus hover mouseover mouseenter")},create:function(e,t){},source:handleLookupAutocomplete,select:handleSelectAutocomplete,appendTo:"#ib-autocomplete-add"}),c.autocomplete("instance")._renderItem=function(e,t){return("complex"===t.type?n("<li>").append('<div title="'+t.label+'">'+t.label+'<span class="autocomplete-item-type">Complex / Subdivision</span></div>'):n("<li>").append('<div title="'+t.label+'">'+t.label+'<span class="autocomplete-item-type">'+t.type+"</span></div>")).appendTo(e)},c.on("focus",handleFocusAutocompleteEvent),c.on("blur",handleBlurAutocompleteEvent),c.on("keypress",handleKeyPressAutocompleteEvent),c.on("keyup",handleKeyUpAutocompleteEvent),c.on("search",handleClearAutocompleteEvent),c.on("paste",handlePasteAutocompleteEvent))})}(jQuery);