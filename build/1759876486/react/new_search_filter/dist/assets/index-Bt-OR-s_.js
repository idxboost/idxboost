var t,e,n=Object.defineProperty,i=(t,e,i)=>(((t,e,i)=>{e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);import{polygon as s,multiPolygon as r}from"./index-DOZZYVIg.js";import{g as o}from"./index-CcKEQ2Od.js";var l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,u=Math.floor,a="[BigNumber Error] ",f=a+"Number primitive has more than 15 significant digits: ",c=1e14,p=14,g=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,d=1e9;function x(t){var e=0|t;return t>0||t===e?e:e-1}function b(t){for(var e,n,i=1,s=t.length,r=t[0]+"";i<s;){for(e=t[i++]+"",n=p-e.length;n--;e="0"+e);r+=e}for(s=r.length;48===r.charCodeAt(--s););return r.slice(0,s+1||1)}function w(t,e){var n,i,s=t.c,r=e.c,o=t.s,l=e.s,h=t.e,u=e.e;if(!o||!l)return null;if(n=s&&!s[0],i=r&&!r[0],n||i)return n?i?0:-l:o;if(o!=l)return o;if(n=o<0,i=h==u,!s||!r)return i?0:!s^n?1:-1;if(!i)return h>u^n?1:-1;for(l=(h=s.length)<(u=r.length)?h:u,o=0;o<l;o++)if(s[o]!=r[o])return s[o]>r[o]^n?1:-1;return h==u?0:h>u^n?1:-1}function E(t,e,n,i){if(t<e||t>n||t!==u(t))throw Error(a+(i||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function v(t){var e=t.c.length-1;return x(t.e/p)==e&&t.c[e]%2!=0}function S(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function T(t,e,n){var i,s;if(e<0){for(s=n+".";++e;s+=n);t=s+t}else if(++e>(i=t.length)){for(s=n,e-=i;--e;s+=n);t+=s}else e<i&&(t=t.slice(0,e)+"."+t.slice(e));return t}var R=function t(e){var n,i,s,r=M.prototype={constructor:M,toString:null,valueOf:null},o=new M(1),R=20,N=4,O=-7,L=21,_=-1e7,I=1e7,P=!1,A=1,k=0,C={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz",G=!0;function M(t,e){var n,r,o,h,a,c,y,m,d=this;if(!(d instanceof M))return new M(t,e);if(null==e){if(t&&!0===t._isBigNumber)return d.s=t.s,void(!t.c||t.e>I?d.c=d.e=null:t.e<_?d.c=[d.e=0]:(d.e=t.e,d.c=t.c.slice()));if((c="number"==typeof t)&&0*t==0){if(d.s=1/t<0?(t=-t,-1):1,t===~~t){for(h=0,a=t;a>=10;a/=10,h++);return void(h>I?d.c=d.e=null:(d.e=h,d.c=[t]))}m=String(t)}else{if(!l.test(m=String(t)))return s(d,m,c);d.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(h=m.indexOf("."))>-1&&(m=m.replace(".","")),(a=m.search(/e/i))>0?(h<0&&(h=a),h+=+m.slice(a+1),m=m.substring(0,a)):h<0&&(h=m.length)}else{if(E(e,2,B.length,"Base"),10==e&&G)return U(d=new M(t),R+d.e+1,N);if(m=String(t),c="number"==typeof t){if(0*t!=0)return s(d,m,c,e);if(d.s=1/t<0?(m=m.slice(1),-1):1,M.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(f+t)}else d.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(n=B.slice(0,e),h=a=0,y=m.length;a<y;a++)if(n.indexOf(r=m.charAt(a))<0){if("."==r){if(a>h){h=y;continue}}else if(!o&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){o=!0,a=-1,h=0;continue}return s(d,String(t),c,e)}c=!1,(h=(m=i(m,e,10,d.s)).indexOf("."))>-1?m=m.replace(".",""):h=m.length}for(a=0;48===m.charCodeAt(a);a++);for(y=m.length;48===m.charCodeAt(--y););if(m=m.slice(a,++y)){if(y-=a,c&&M.DEBUG&&y>15&&(t>g||t!==u(t)))throw Error(f+d.s*t);if((h=h-a-1)>I)d.c=d.e=null;else if(h<_)d.c=[d.e=0];else{if(d.e=h,d.c=[],a=(h+1)%p,h<0&&(a+=p),a<y){for(a&&d.c.push(+m.slice(0,a)),y-=p;a<y;)d.c.push(+m.slice(a,a+=p));a=p-(m=m.slice(a)).length}else a-=y;for(;a--;m+="0");d.c.push(+m)}}else d.c=[d.e=0]}function q(t,e,n,i){var s,r,o,l,h;if(null==n?n=N:E(n,0,8),!t.c)return t.toString();if(s=t.c[0],o=t.e,null==e)h=b(t.c),h=1==i||2==i&&(o<=O||o>=L)?S(h,o):T(h,o,"0");else if(r=(t=U(new M(t),e,n)).e,l=(h=b(t.c)).length,1==i||2==i&&(e<=r||r<=O)){for(;l<e;h+="0",l++);h=S(h,r)}else if(e-=o+(2===i&&r>o),h=T(h,r,"0"),r+1>l){if(--e>0)for(h+=".";e--;h+="0");}else if((e+=r-l)>0)for(r+1==l&&(h+=".");e--;h+="0");return t.s<0&&s?"-"+h:h}function z(t,e){for(var n,i,s=1,r=new M(t[0]);s<t.length;s++)(!(i=new M(t[s])).s||(n=w(r,i))===e||0===n&&r.s===e)&&(r=i);return r}function D(t,e,n){for(var i=1,s=e.length;!e[--s];e.pop());for(s=e[0];s>=10;s/=10,i++);return(n=i+n*p-1)>I?t.c=t.e=null:n<_?t.c=[t.e=0]:(t.e=n,t.c=e),t}function U(t,e,n,i){var s,r,o,l,a,f,g,m=t.c,d=y;if(m){t:{for(s=1,l=m[0];l>=10;l/=10,s++);if((r=e-s)<0)r+=p,o=e,a=m[f=0],g=u(a/d[s-o-1]%10);else if((f=h((r+1)/p))>=m.length){if(!i)break t;for(;m.length<=f;m.push(0));a=g=0,s=1,o=(r%=p)-p+1}else{for(a=l=m[f],s=1;l>=10;l/=10,s++);g=(o=(r%=p)-p+s)<0?0:u(a/d[s-o-1]%10)}if(i=i||e<0||null!=m[f+1]||(o<0?a:a%d[s-o-1]),i=n<4?(g||i)&&(0==n||n==(t.s<0?3:2)):g>5||5==g&&(4==n||i||6==n&&(r>0?o>0?a/d[s-o]:0:m[f-1])%10&1||n==(t.s<0?8:7)),e<1||!m[0])return m.length=0,i?(e-=t.e+1,m[0]=d[(p-e%p)%p],t.e=-e||0):m[0]=t.e=0,t;if(0==r?(m.length=f,l=1,f--):(m.length=f+1,l=d[p-r],m[f]=o>0?u(a/d[s-o]%d[o])*l:0),i)for(;;){if(0==f){for(r=1,o=m[0];o>=10;o/=10,r++);for(o=m[0]+=l,l=1;o>=10;o/=10,l++);r!=l&&(t.e++,m[0]==c&&(m[0]=1));break}if(m[f]+=l,m[f]!=c)break;m[f--]=0,l=1}for(r=m.length;0===m[--r];m.pop());}t.e>I?t.c=t.e=null:t.e<_&&(t.c=[t.e=0])}return t}function F(t){var e,n=t.e;return null===n?t.toString():(e=b(t.c),e=n<=O||n>=L?S(e,n):T(e,n,"0"),t.s<0?"-"+e:e)}return M.clone=t,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(a+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(E(n=t[e],0,d,e),R=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(E(n=t[e],0,8,e),N=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(E(n[0],-d,0,e),E(n[1],0,d,e),O=n[0],L=n[1]):(E(n,-d,d,e),O=-(L=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)E(n[0],-d,-1,e),E(n[1],1,d,e),_=n[0],I=n[1];else{if(E(n,-d,d,e),!n)throw Error(a+e+" cannot be zero: "+n);_=-(I=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(a+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw P=!n,Error(a+"crypto unavailable");P=n}else P=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(E(n=t[e],0,9,e),A=n),t.hasOwnProperty(e="POW_PRECISION")&&(E(n=t[e],0,d,e),k=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(a+e+" not an object: "+n);C=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(a+e+" invalid: "+n);G="0123456789"==n.slice(0,10),B=n}}return{DECIMAL_PLACES:R,ROUNDING_MODE:N,EXPONENTIAL_AT:[O,L],RANGE:[_,I],CRYPTO:P,MODULO_MODE:A,POW_PRECISION:k,FORMAT:C,ALPHABET:B}},M.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!M.DEBUG)return!0;var e,n,i=t.c,s=t.e,r=t.s;t:if("[object Array]"=={}.toString.call(i)){if((1===r||-1===r)&&s>=-d&&s<=d&&s===u(s)){if(0===i[0]){if(0===s&&1===i.length)return!0;break t}if((e=(s+1)%p)<1&&(e+=p),String(i[0]).length==e){for(e=0;e<i.length;e++)if((n=i[e])<0||n>=c||n!==u(n))break t;if(0!==n)return!0}}}else if(null===i&&null===s&&(null===r||1===r||-1===r))return!0;throw Error(a+"Invalid BigNumber: "+t)},M.maximum=M.max=function(){return z(arguments,-1)},M.minimum=M.min=function(){return z(arguments,1)},M.random=function(){var t=9007199254740992,e=Math.random()*t&2097151?function(){return u(Math.random()*t)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(t){var n,i,s,r,l,f=0,c=[],g=new M(o);if(null==t?t=R:E(t,0,d),r=h(t/p),P)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(r*=2));f<r;)(l=131072*n[f]+(n[f+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),n[f]=i[0],n[f+1]=i[1]):(c.push(l%1e14),f+=2);f=r/2}else{if(!crypto.randomBytes)throw P=!1,Error(a+"crypto unavailable");for(n=crypto.randomBytes(r*=7);f<r;)(l=281474976710656*(31&n[f])+1099511627776*n[f+1]+4294967296*n[f+2]+16777216*n[f+3]+(n[f+4]<<16)+(n[f+5]<<8)+n[f+6])>=9e15?crypto.randomBytes(7).copy(n,f):(c.push(l%1e14),f+=7);f=r/7}if(!P)for(;f<r;)(l=e())<9e15&&(c[f++]=l%1e14);for(r=c[--f],t%=p,r&&t&&(l=y[p-t],c[f]=u(r/l)*l);0===c[f];c.pop(),f--);if(f<0)c=[s=0];else{for(s=-1;0===c[0];c.splice(0,1),s-=p);for(f=1,l=c[0];l>=10;l/=10,f++);f<p&&(s-=p-f)}return g.e=s,g.c=c,g}}(),M.sum=function(){for(var t=1,e=arguments,n=new M(e[0]);t<e.length;)n=n.plus(e[t++]);return n},i=function(){var t="0123456789";function e(t,e,n,i){for(var s,r,o=[0],l=0,h=t.length;l<h;){for(r=o.length;r--;o[r]*=e);for(o[0]+=i.indexOf(t.charAt(l++)),s=0;s<o.length;s++)o[s]>n-1&&(null==o[s+1]&&(o[s+1]=0),o[s+1]+=o[s]/n|0,o[s]%=n)}return o.reverse()}return function(i,s,r,o,l){var h,u,a,f,c,p,g,y,m=i.indexOf("."),d=R,x=N;for(m>=0&&(f=k,k=0,i=i.replace(".",""),p=(y=new M(s)).pow(i.length-m),k=f,y.c=e(T(b(p.c),p.e,"0"),10,r,t),y.e=y.c.length),a=f=(g=e(i,s,r,l?(h=B,t):(h=t,B))).length;0==g[--f];g.pop());if(!g[0])return h.charAt(0);if(m<0?--a:(p.c=g,p.e=a,p.s=o,g=(p=n(p,y,d,x,r)).c,c=p.r,a=p.e),m=g[u=a+d+1],f=r/2,c=c||u<0||null!=g[u+1],c=x<4?(null!=m||c)&&(0==x||x==(p.s<0?3:2)):m>f||m==f&&(4==x||c||6==x&&1&g[u-1]||x==(p.s<0?8:7)),u<1||!g[0])i=c?T(h.charAt(1),-d,h.charAt(0)):h.charAt(0);else{if(g.length=u,c)for(--r;++g[--u]>r;)g[u]=0,u||(++a,g=[1].concat(g));for(f=g.length;!g[--f];);for(m=0,i="";m<=f;i+=h.charAt(g[m++]));i=T(i,a,h.charAt(0))}return i}}(),n=function(){function t(t,e,n){var i,s,r,o,l=0,h=t.length,u=e%m,a=e/m|0;for(t=t.slice();h--;)l=((s=u*(r=t[h]%m)+(i=a*r+(o=t[h]/m|0)*u)%m*m+l)/n|0)+(i/m|0)+a*o,t[h]=s%n;return l&&(t=[l].concat(t)),t}function e(t,e,n,i){var s,r;if(n!=i)r=n>i?1:-1;else for(s=r=0;s<n;s++)if(t[s]!=e[s]){r=t[s]>e[s]?1:-1;break}return r}function n(t,e,n,i){for(var s=0;n--;)t[n]-=s,s=t[n]<e[n]?1:0,t[n]=s*i+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(i,s,r,o,l){var h,a,f,g,y,m,d,b,w,E,v,S,T,R,N,O,L,_=i.s==s.s?1:-1,I=i.c,P=s.c;if(!(I&&I[0]&&P&&P[0]))return new M(i.s&&s.s&&(I?!P||I[0]!=P[0]:P)?I&&0==I[0]||!P?0*_:_/0:NaN);for(w=(b=new M(_)).c=[],_=r+(a=i.e-s.e)+1,l||(l=c,a=x(i.e/p)-x(s.e/p),_=_/p|0),f=0;P[f]==(I[f]||0);f++);if(P[f]>(I[f]||0)&&a--,_<0)w.push(1),g=!0;else{for(R=I.length,O=P.length,f=0,_+=2,(y=u(l/(P[0]+1)))>1&&(P=t(P,y,l),I=t(I,y,l),O=P.length,R=I.length),T=O,v=(E=I.slice(0,O)).length;v<O;E[v++]=0);L=P.slice(),L=[0].concat(L),N=P[0],P[1]>=l/2&&N++;do{if(y=0,(h=e(P,E,O,v))<0){if(S=E[0],O!=v&&(S=S*l+(E[1]||0)),(y=u(S/N))>1)for(y>=l&&(y=l-1),d=(m=t(P,y,l)).length,v=E.length;1==e(m,E,d,v);)y--,n(m,O<d?L:P,d,l),d=m.length,h=1;else 0==y&&(h=y=1),d=(m=P.slice()).length;if(d<v&&(m=[0].concat(m)),n(E,m,v,l),v=E.length,-1==h)for(;e(P,E,O,v)<1;)y++,n(E,O<v?L:P,v,l),v=E.length}else 0===h&&(y++,E=[0]);w[f++]=y,E[0]?E[v++]=I[T]||0:(E=[I[T]],v=1)}while((T++<R||null!=E[0])&&_--);g=null!=E[0],w[0]||w.splice(0,1)}if(l==c){for(f=1,_=w[0];_>=10;_/=10,f++);U(b,r+(b.e=f+a*p-1)+1,o,g)}else b.e=a,b.r=+g;return b}}(),s=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,i=/^-?(Infinity|NaN)$/,s=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(r,o,l,h){var u,f=l?o:o.replace(s,"");if(i.test(f))r.s=isNaN(f)?null:f<0?-1:1;else{if(!l&&(f=f.replace(t,function(t,e,n){return u="x"==(n=n.toLowerCase())?16:"b"==n?2:8,h&&h!=u?t:e}),h&&(u=h,f=f.replace(e,"$1").replace(n,"0.$1")),o!=f))return new M(f,u);if(M.DEBUG)throw Error(a+"Not a"+(h?" base "+h:"")+" number: "+o);r.s=null}r.c=r.e=null}}(),r.absoluteValue=r.abs=function(){var t=new M(this);return t.s<0&&(t.s=1),t},r.comparedTo=function(t,e){return w(this,new M(t,e))},r.decimalPlaces=r.dp=function(t,e){var n,i,s,r=this;if(null!=t)return E(t,0,d),null==e?e=N:E(e,0,8),U(new M(r),t+r.e+1,e);if(!(n=r.c))return null;if(i=((s=n.length-1)-x(this.e/p))*p,s=n[s])for(;s%10==0;s/=10,i--);return i<0&&(i=0),i},r.dividedBy=r.div=function(t,e){return n(this,new M(t,e),R,N)},r.dividedToIntegerBy=r.idiv=function(t,e){return n(this,new M(t,e),0,1)},r.exponentiatedBy=r.pow=function(t,e){var n,i,s,r,l,f,c,g,y=this;if((t=new M(t)).c&&!t.isInteger())throw Error(a+"Exponent not an integer: "+F(t));if(null!=e&&(e=new M(e)),l=t.e>14,!y.c||!y.c[0]||1==y.c[0]&&!y.e&&1==y.c.length||!t.c||!t.c[0])return g=new M(Math.pow(+F(y),l?t.s*(2-v(t)):+F(t))),e?g.mod(e):g;if(f=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new M(NaN);(i=!f&&y.isInteger()&&e.isInteger())&&(y=y.mod(e))}else{if(t.e>9&&(y.e>0||y.e<-1||(0==y.e?y.c[0]>1||l&&y.c[1]>=24e7:y.c[0]<8e13||l&&y.c[0]<=9999975e7)))return r=y.s<0&&v(t)?-0:0,y.e>-1&&(r=1/r),new M(f?1/r:r);k&&(r=h(k/p+2))}for(l?(n=new M(.5),f&&(t.s=1),c=v(t)):c=(s=Math.abs(+F(t)))%2,g=new M(o);;){if(c){if(!(g=g.times(y)).c)break;r?g.c.length>r&&(g.c.length=r):i&&(g=g.mod(e))}if(s){if(0===(s=u(s/2)))break;c=s%2}else if(U(t=t.times(n),t.e+1,1),t.e>14)c=v(t);else{if(0===(s=+F(t)))break;c=s%2}y=y.times(y),r?y.c&&y.c.length>r&&(y.c.length=r):i&&(y=y.mod(e))}return i?g:(f&&(g=o.div(g)),e?g.mod(e):r?U(g,k,N,void 0):g)},r.integerValue=function(t){var e=new M(this);return null==t?t=N:E(t,0,8),U(e,e.e+1,t)},r.isEqualTo=r.eq=function(t,e){return 0===w(this,new M(t,e))},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(t,e){return w(this,new M(t,e))>0},r.isGreaterThanOrEqualTo=r.gte=function(t,e){return 1===(e=w(this,new M(t,e)))||0===e},r.isInteger=function(){return!!this.c&&x(this.e/p)>this.c.length-2},r.isLessThan=r.lt=function(t,e){return w(this,new M(t,e))<0},r.isLessThanOrEqualTo=r.lte=function(t,e){return-1===(e=w(this,new M(t,e)))||0===e},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&0==this.c[0]},r.minus=function(t,e){var n,i,s,r,o=this,l=o.s;if(e=(t=new M(t,e)).s,!l||!e)return new M(NaN);if(l!=e)return t.s=-e,o.plus(t);var h=o.e/p,u=t.e/p,a=o.c,f=t.c;if(!h||!u){if(!a||!f)return a?(t.s=-e,t):new M(f?o:NaN);if(!a[0]||!f[0])return f[0]?(t.s=-e,t):new M(a[0]?o:3==N?-0:0)}if(h=x(h),u=x(u),a=a.slice(),l=h-u){for((r=l<0)?(l=-l,s=a):(u=h,s=f),s.reverse(),e=l;e--;s.push(0));s.reverse()}else for(i=(r=(l=a.length)<(e=f.length))?l:e,l=e=0;e<i;e++)if(a[e]!=f[e]){r=a[e]<f[e];break}if(r&&(s=a,a=f,f=s,t.s=-t.s),(e=(i=f.length)-(n=a.length))>0)for(;e--;a[n++]=0);for(e=c-1;i>l;){if(a[--i]<f[i]){for(n=i;n&&!a[--n];a[n]=e);--a[n],a[i]+=c}a[i]-=f[i]}for(;0==a[0];a.splice(0,1),--u);return a[0]?D(t,a,u):(t.s=3==N?-1:1,t.c=[t.e=0],t)},r.modulo=r.mod=function(t,e){var i,s,r=this;return t=new M(t,e),!r.c||!t.s||t.c&&!t.c[0]?new M(NaN):!t.c||r.c&&!r.c[0]?new M(r):(9==A?(s=t.s,t.s=1,i=n(r,t,0,3),t.s=s,i.s*=s):i=n(r,t,0,A),(t=r.minus(i.times(t))).c[0]||1!=A||(t.s=r.s),t)},r.multipliedBy=r.times=function(t,e){var n,i,s,r,o,l,h,u,a,f,g,y,d,b,w,E=this,v=E.c,S=(t=new M(t,e)).c;if(!(v&&S&&v[0]&&S[0]))return!E.s||!t.s||v&&!v[0]&&!S||S&&!S[0]&&!v?t.c=t.e=t.s=null:(t.s*=E.s,v&&S?(t.c=[0],t.e=0):t.c=t.e=null),t;for(i=x(E.e/p)+x(t.e/p),t.s*=E.s,(h=v.length)<(f=S.length)&&(d=v,v=S,S=d,s=h,h=f,f=s),s=h+f,d=[];s--;d.push(0));for(b=c,w=m,s=f;--s>=0;){for(n=0,g=S[s]%w,y=S[s]/w|0,r=s+(o=h);r>s;)n=((u=g*(u=v[--o]%w)+(l=y*u+(a=v[o]/w|0)*g)%w*w+d[r]+n)/b|0)+(l/w|0)+y*a,d[r--]=u%b;d[r]=n}return n?++i:d.splice(0,1),D(t,d,i)},r.negated=function(){var t=new M(this);return t.s=-t.s||null,t},r.plus=function(t,e){var n,i=this,s=i.s;if(e=(t=new M(t,e)).s,!s||!e)return new M(NaN);if(s!=e)return t.s=-e,i.minus(t);var r=i.e/p,o=t.e/p,l=i.c,h=t.c;if(!r||!o){if(!l||!h)return new M(s/0);if(!l[0]||!h[0])return h[0]?t:new M(l[0]?i:0*s)}if(r=x(r),o=x(o),l=l.slice(),s=r-o){for(s>0?(o=r,n=h):(s=-s,n=l),n.reverse();s--;n.push(0));n.reverse()}for((s=l.length)-(e=h.length)<0&&(n=h,h=l,l=n,e=s),s=0;e;)s=(l[--e]=l[e]+h[e]+s)/c|0,l[e]=c===l[e]?0:l[e]%c;return s&&(l=[s].concat(l),++o),D(t,l,o)},r.precision=r.sd=function(t,e){var n,i,s,r=this;if(null!=t&&t!==!!t)return E(t,1,d),null==e?e=N:E(e,0,8),U(new M(r),t,e);if(!(n=r.c))return null;if(i=(s=n.length-1)*p+1,s=n[s]){for(;s%10==0;s/=10,i--);for(s=n[0];s>=10;s/=10,i++);}return t&&r.e+1>i&&(i=r.e+1),i},r.shiftedBy=function(t){return E(t,-9007199254740991,g),this.times("1e"+t)},r.squareRoot=r.sqrt=function(){var t,e,i,s,r,o=this,l=o.c,h=o.s,u=o.e,a=R+4,f=new M("0.5");if(1!==h||!l||!l[0])return new M(!h||h<0&&(!l||l[0])?NaN:l?o:1/0);if(0==(h=Math.sqrt(+F(o)))||h==1/0?(((e=b(l)).length+u)%2==0&&(e+="0"),h=Math.sqrt(+e),u=x((u+1)/2)-(u<0||u%2),i=new M(e=h==1/0?"5e"+u:(e=h.toExponential()).slice(0,e.indexOf("e")+1)+u)):i=new M(h+""),i.c[0])for((h=(u=i.e)+a)<3&&(h=0);;)if(r=i,i=f.times(r.plus(n(o,r,a,1))),b(r.c).slice(0,h)===(e=b(i.c)).slice(0,h)){if(i.e<u&&--h,"9999"!=(e=e.slice(h-3,h+1))&&(s||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(U(i,i.e+R+2,1),t=!i.times(i).eq(o));break}if(!s&&(U(r,r.e+R+2,0),r.times(r).eq(o))){i=r;break}a+=4,h+=4,s=1}return U(i,i.e+R+1,N,t)},r.toExponential=function(t,e){return null!=t&&(E(t,0,d),t++),q(this,t,e,1)},r.toFixed=function(t,e){return null!=t&&(E(t,0,d),t=t+this.e+1),q(this,t,e)},r.toFormat=function(t,e,n){var i,s=this;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=C;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(i=s.toFixed(t,e),s.c){var r,o=i.split("."),l=+n.groupSize,h=+n.secondaryGroupSize,u=n.groupSeparator||"",f=o[0],c=o[1],p=s.s<0,g=p?f.slice(1):f,y=g.length;if(h&&(r=l,l=h,h=r,y-=r),l>0&&y>0){for(r=y%l||l,f=g.substr(0,r);r<y;r+=l)f+=u+g.substr(r,l);h>0&&(f+=u+g.slice(r)),p&&(f="-"+f)}i=c?f+(n.decimalSeparator||"")+((h=+n.fractionGroupSize)?c.replace(new RegExp("\\d{"+h+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):c):f}return(n.prefix||"")+i+(n.suffix||"")},r.toFraction=function(t){var e,i,s,r,l,h,u,f,c,g,m,d,x=this,w=x.c;if(null!=t&&(!(u=new M(t)).isInteger()&&(u.c||1!==u.s)||u.lt(o)))throw Error(a+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+F(u));if(!w)return new M(x);for(e=new M(o),c=i=new M(o),s=f=new M(o),d=b(w),l=e.e=d.length-x.e-1,e.c[0]=y[(h=l%p)<0?p+h:h],t=!t||u.comparedTo(e)>0?l>0?e:c:u,h=I,I=1/0,u=new M(d),f.c[0]=0;g=n(u,e,0,1),1!=(r=i.plus(g.times(s))).comparedTo(t);)i=s,s=r,c=f.plus(g.times(r=c)),f=r,e=u.minus(g.times(r=e)),u=r;return r=n(t.minus(i),s,0,1),f=f.plus(r.times(c)),i=i.plus(r.times(s)),f.s=c.s=x.s,m=n(c,s,l*=2,N).minus(x).abs().comparedTo(n(f,i,l,N).minus(x).abs())<1?[c,s]:[f,i],I=h,m},r.toNumber=function(){return+F(this)},r.toPrecision=function(t,e){return null!=t&&E(t,1,d),q(this,t,e,2)},r.toString=function(t){var e,n=this,s=n.s,r=n.e;return null===r?s?(e="Infinity",s<0&&(e="-"+e)):e="NaN":(null==t?e=r<=O||r>=L?S(b(n.c),r):T(b(n.c),r,"0"):10===t&&G?e=T(b((n=U(new M(n),R+r+1,N)).c),n.e,"0"):(E(t,2,B.length,"Base"),e=i(T(b(n.c),r,"0"),10,t,s,!0)),s<0&&n.c[0]&&(e="-"+e)),e},r.valueOf=r.toJSON=function(){return F(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,null!=e&&M.set(e),M}(),N=class{constructor(t){i(this,"key"),i(this,"left",null),i(this,"right",null),this.key=t}},O=class extends N{constructor(t){super(t)}},L=class{constructor(){i(this,"size",0),i(this,"modificationCount",0),i(this,"splayCount",0)}splay(t){const e=this.root;if(null==e)return this.compare(t,t),-1;let n=null,i=null,s=null,r=null,o=e;const l=this.compare;let h;for(;;)if(h=l(o.key,t),h>0){let e=o.left;if(null==e)break;if(h=l(e.key,t),h>0&&(o.left=e.right,e.right=o,o=e,e=o.left,null==e))break;null==n?i=o:n.left=o,n=o,o=e}else{if(!(h<0))break;{let e=o.right;if(null==e)break;if(h=l(e.key,t),h<0&&(o.right=e.left,e.left=o,o=e,e=o.right,null==e))break;null==s?r=o:s.right=o,s=o,o=e}}return null!=s&&(s.right=o.left,o.left=r),null!=n&&(n.left=o.right,o.right=i),this.root!==o&&(this.root=o,this.splayCount++),h}splayMin(t){let e=t,n=e.left;for(;null!=n;){const t=n;e.left=t.right,t.right=e,e=t,n=e.left}return e}splayMax(t){let e=t,n=e.right;for(;null!=n;){const t=n;e.right=t.left,t.left=e,e=t,n=e.right}return e}_delete(t){if(null==this.root)return null;if(0!=this.splay(t))return null;let e=this.root;const n=e,i=e.left;if(this.size--,null==i)this.root=e.right;else{const t=e.right;e=this.splayMax(i),e.right=t,this.root=e}return this.modificationCount++,n}addNewRoot(t,e){this.size++,this.modificationCount++;const n=this.root;null!=n?(e<0?(t.left=n,t.right=n.right,n.right=null):(t.right=n,t.left=n.left,n.left=null),this.root=t):this.root=t}_first(){const t=this.root;return null==t?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return null==t?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&0==this.splay(t)}defaultCompare(){return(t,e)=>t<e?-1:t>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}},_=(e=class extends L{constructor(e,n){super(),i(this,"root",null),i(this,"compare"),i(this,"validKey"),i(this,t,"[object Set]"),this.compare=e??this.defaultCompare(),this.validKey=n??(t=>null!=t&&null!=t)}delete(t){return!!this.validKey(t)&&null!=this._delete(t)}deleteAll(t){for(const e of t)this.delete(e)}forEach(t){const e=this[Symbol.iterator]();let n;for(;n=e.next(),!n.done;)t(n.value,n.value,this)}add(t){const e=this.splay(t);return 0!=e&&this.addNewRoot(new O(t),e),this}addAndReturn(t){const e=this.splay(t);return 0!=e&&this.addNewRoot(new O(t),e),this.root.key}addAll(t){for(const e of t)this.add(e)}isEmpty(){return null==this.root}isNotEmpty(){return null!=this.root}single(){if(0==this.size)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(0==this.size)throw"Bad state: No element";return this._first().key}last(){if(0==this.size)throw"Bad state: No element";return this._last().key}lastBefore(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(this.splay(t)<0)return this.root.key;let e=this.root.left;if(null==e)return null;let n=e.right;for(;null!=n;)e=n,n=e.right;return e.key}firstAfter(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(this.splay(t)>0)return this.root.key;let e=this.root.right;if(null==e)return null;let n=e.left;for(;null!=n;)e=n,n=e.left;return e.key}retainAll(t){const n=new e(this.compare,this.validKey),i=this.modificationCount;for(const e of t){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(e)&&0==this.splay(e)&&n.add(this.root.key)}n.size!=this.size&&(this.root=n.root,this.size=n.size,this.modificationCount++)}lookup(t){return this.validKey(t)?0!=this.splay(t)?null:this.root.key:null}intersection(t){const n=new e(this.compare,this.validKey);for(const e of this)t.has(e)&&n.add(e);return n}difference(t){const n=new e(this.compare,this.validKey);for(const e of this)t.has(e)||n.add(e);return n}union(t){const e=this.clone();return e.addAll(t),e}clone(){const t=new e(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(null==t)return null;const e=new O(t.key);return function t(e,n){let i,s;do{if(i=e.left,s=e.right,null!=i){const e=new O(i.key);n.left=e,t(i,e)}if(null!=s){const t=new O(s.key);n.right=t,e=s,n=t}}while(null!=s)}(t,e),e}toSet(){return this.clone()}entries(){return new A(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new P(this.wrap())}},t=Symbol.toStringTag,e),I=class{constructor(t){i(this,"tree"),i(this,"path",new Array),i(this,"modificationCount",null),i(this,"splayCount"),this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;null!=t;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(null==this.modificationCount){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;null!=t;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],e=t.right;if(null!=e){for(;null!=e;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}},P=class extends I{getValue(t){return t.key}},A=class extends I{getValue(t){return[t.key,t.key]}},k=t=>()=>t,C=t=>{const e=t?(e,n)=>n.minus(e).abs().isLessThanOrEqualTo(t):k(!1);return(t,n)=>e(t,n)?0:t.comparedTo(n)};function B(t){const e=t?(e,n,i,s,r)=>e.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(n).exponentiatedBy(2).plus(r.minus(i).exponentiatedBy(2)).times(t)):k(!1);return(t,n,i)=>{const s=t.x,r=t.y,o=i.x,l=i.y,h=r.minus(l).times(n.x.minus(o)).minus(s.minus(o).times(n.y.minus(l)));return e(h,s,r,o,l)?0:h.comparedTo(0)}}var G=t=>t,M=t=>{if(t){const e=new _(C(t)),n=new _(C(t)),i=(t,e)=>e.addAndReturn(t),s=t=>({x:i(t.x,e),y:i(t.y,n)});return s({x:new R(0),y:new R(0)}),s}return G},q=t=>({set:t=>{z=q(t)},reset:()=>q(t),compare:C(t),snap:M(t),orient:B(t)}),z=q(),D=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),U=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;const n=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,i=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y}}},F=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),j=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),$=t=>j(t,t).sqrt(),V=(t,e,n)=>{const i={x:e.x.minus(t.x),y:e.y.minus(t.y)},s={x:n.x.minus(t.x),y:n.y.minus(t.y)};return F(s,i).div($(s)).div($(i))},K=(t,e,n)=>{const i={x:e.x.minus(t.x),y:e.y.minus(t.y)},s={x:n.x.minus(t.x),y:n.y.minus(t.y)};return j(s,i).div($(s)).div($(i))},Z=(t,e,n)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(n.minus(t.y))),y:n},H=(t,e,n)=>e.x.isZero()?null:{x:n,y:t.y.plus(e.y.div(e.x).times(n.minus(t.x)))},Y=class t{constructor(t,e){i(this,"point"),i(this,"isLeft"),i(this,"segment"),i(this,"otherSE"),i(this,"consumedBy"),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}static compare(e,n){const i=t.comparePoints(e.point,n.point);return 0!==i?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:it.compare(e.segment,n.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let n=0,i=e.length;n<i;n++){const t=e[n];this.point.events.push(t),t.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(void 0===n.segment.consumedBy)for(let i=e+1;i<t;i++){const t=this.point.events[i];void 0===t.consumedBy&&n.otherSE.point.events===t.otherSE.point.events&&n.segment.consume(t.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,n=n=>{const i=n.otherSE;e.set(n,{sine:V(this.point,t.point,i.point),cosine:K(this.point,t.point,i.point)})};return(t,i)=>{e.has(t)||n(t),e.has(i)||n(i);const{sine:s,cosine:r}=e.get(t),{sine:o,cosine:l}=e.get(i);return s.isGreaterThanOrEqualTo(0)&&o.isGreaterThanOrEqualTo(0)?r.isLessThan(l)?1:r.isGreaterThan(l)?-1:0:s.isLessThan(0)&&o.isLessThan(0)?r.isLessThan(l)?-1:r.isGreaterThan(l)?1:0:o.isLessThan(s)?-1:o.isGreaterThan(s)?1:0}}},W=class t{constructor(t){i(this,"events"),i(this,"poly"),i(this,"_isExteriorRing"),i(this,"_enclosingRing"),this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}static factory(e){const n=[];for(let i=0,s=e.length;i<s;i++){const s=e[i];if(!s.isInResult()||s.ringOut)continue;let r=null,o=s.leftSE,l=s.rightSE;const h=[o],u=o.point,a=[];for(;r=o,o=l,h.push(o),o.point!==u;)for(;;){const e=o.getAvailableLinkedEvents();if(0===e.length){const t=h[0].point,e=h[h.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===e.length){l=e[0].otherSE;break}let i=null;for(let t=0,n=a.length;t<n;t++)if(a[t].point===o.point){i=t;break}if(null!==i){const e=a.splice(i)[0],s=h.splice(e.index);s.unshift(s[0].otherSE),n.push(new t(s.reverse()));continue}a.push({index:h.length,point:o.point});const s=o.getLeftmostComparator(r);l=e.sort(s)[0].otherSE;break}n.push(new t(h))}return n}getGeom(){let t=this.events[0].point;const e=[t];for(let h=1,u=this.events.length-1;h<u;h++){const n=this.events[h].point,i=this.events[h+1].point;0!==z.orient(n,t,i)&&(e.push(n),t=n)}if(1===e.length)return null;const n=e[0],i=e[1];0===z.orient(n,t,i)&&e.shift(),e.push(e[0]);const s=this.isExteriorRing()?1:-1,r=this.isExteriorRing()?0:e.length-1,o=this.isExteriorRing()?e.length:-1,l=[];for(let h=r;h!=o;h+=s)l.push([e[h].x.toNumber(),e[h].y.toNumber()]);return l}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const e=this.events[i];Y.compare(t,e)>0&&(t=e)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut?.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut?.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}},X=class{constructor(t){i(this,"exteriorRing"),i(this,"interiorRings"),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=this.exteriorRing.getGeom();if(null===t)return null;const e=[t];for(let n=0,i=this.interiorRings.length;n<i;n++){const t=this.interiorRings[n].getGeom();null!==t&&e.push(t)}return e}},J=class{constructor(t){i(this,"rings"),i(this,"polys"),this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}_composePolys(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new X(i));else{const t=i.enclosingRing();t?.poly||e.push(new X(t)),t?.poly?.addInterior(i)}}return e}},Q=class{constructor(t,e=it.compare){i(this,"queue"),i(this,"tree"),i(this,"segments"),this.queue=t,this.tree=new _(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(e),n;t.isLeft&&this.tree.add(e);let i=e,s=e;do{i=this.tree.lastBefore(i)}while(null!=i&&null!=i.consumedBy);do{s=this.tree.firstAfter(s)}while(null!=s&&null!=s.consumedBy);if(t.isLeft){let r=null;if(i){const t=i.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(r=t),!i.isAnEndpoint(t))){const e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}let o=null;if(s){const t=s.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(o=t),!s.isAnEndpoint(t))){const e=this._splitSafely(s,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}if(null!==r||null!==o){let t=null;t=null===r?o:null===o||Y.comparePoints(r,o)<=0?r:o,this.queue.delete(e.rightSE),n.push(e.rightSE);const i=e.split(t);for(let e=0,s=i.length;e<s;e++)n.push(i[e])}n.length>0?(this.tree.delete(e),n.push(t)):(this.segments.push(e),e.prev=i)}else{if(i&&s){const t=i.getIntersection(s);if(null!==t){if(!i.isAnEndpoint(t)){const e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}if(!s.isAnEndpoint(t)){const e=this._splitSafely(s,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}}this.tree.delete(e)}return n}_splitSafely(t,e){this.tree.delete(t);const n=t.rightSE;this.queue.delete(n);const i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.add(t),i}},tt=new class{constructor(){i(this,"type"),i(this,"numMultiPolys")}run(t,e,n){tt.type=t;const i=[new ot(e,!0)];for(let h=0,u=n.length;h<u;h++)i.push(new ot(n[h],!1));if(tt.numMultiPolys=i.length,"difference"===tt.type){const t=i[0];let e=1;for(;e<i.length;)null!==U(i[e].bbox,t.bbox)?e++:i.splice(e,1)}if("intersection"===tt.type)for(let h=0,u=i.length;h<u;h++){const t=i[h];for(let e=h+1,n=i.length;e<n;e++)if(null===U(t.bbox,i[e].bbox))return[]}const s=new _(Y.compare);for(let h=0,u=i.length;h<u;h++){const t=i[h].getSweepEvents();for(let e=0,n=t.length;e<n;e++)s.add(t[e])}const r=new Q(s);let o=null;for(0!=s.size&&(o=s.first(),s.delete(o));o;){const t=r.process(o);for(let e=0,n=t.length;e<n;e++){const n=t[e];void 0===n.consumedBy&&s.add(n)}0!=s.size?(o=s.first(),s.delete(o)):o=null}z.reset();const l=W.factory(r.segments);return new J(l).getGeom()}},et=tt,nt=0,it=class t{constructor(t,e,n,s){i(this,"id"),i(this,"leftSE"),i(this,"rightSE"),i(this,"rings"),i(this,"windings"),i(this,"ringOut"),i(this,"consumedBy"),i(this,"prev"),i(this,"_prevInResult"),i(this,"_beforeState"),i(this,"_afterState"),i(this,"_isInResult"),this.id=++nt,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=s}static compare(t,e){const n=t.leftSE.point.x,i=e.leftSE.point.x,s=t.rightSE.point.x,r=e.rightSE.point.x;if(r.isLessThan(n))return 1;if(s.isLessThan(i))return-1;const o=t.leftSE.point.y,l=e.leftSE.point.y,h=t.rightSE.point.y,u=e.rightSE.point.y;if(n.isLessThan(i)){if(l.isLessThan(o)&&l.isLessThan(h))return 1;if(l.isGreaterThan(o)&&l.isGreaterThan(h))return-1;const n=t.comparePoint(e.leftSE.point);if(n<0)return 1;if(n>0)return-1;const i=e.comparePoint(t.rightSE.point);return 0!==i?i:-1}if(n.isGreaterThan(i)){if(o.isLessThan(l)&&o.isLessThan(u))return-1;if(o.isGreaterThan(l)&&o.isGreaterThan(u))return 1;const n=e.comparePoint(t.leftSE.point);if(0!==n)return n;const i=t.comparePoint(e.rightSE.point);return i<0?1:i>0?-1:1}if(o.isLessThan(l))return-1;if(o.isGreaterThan(l))return 1;if(s.isLessThan(r)){const n=e.comparePoint(t.rightSE.point);if(0!==n)return n}if(s.isGreaterThan(r)){const n=t.comparePoint(e.rightSE.point);if(n<0)return 1;if(n>0)return-1}if(!s.eq(r)){const t=h.minus(o),e=s.minus(n),a=u.minus(l),f=r.minus(i);if(t.isGreaterThan(e)&&a.isLessThan(f))return 1;if(t.isLessThan(e)&&a.isGreaterThan(f))return-1}return s.isGreaterThan(r)?1:s.isLessThan(r)||h.isLessThan(u)?-1:h.isGreaterThan(u)?1:t.id<e.id?-1:t.id>e.id?1:0}static fromRing(e,n,i){let s,r,o;const l=Y.comparePoints(e,n);if(l<0)s=e,r=n,o=1;else{if(!(l>0))throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);s=n,r=e,o=-1}const h=new Y(s,!0),u=new Y(r,!1);return new t(h,u,[i],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return z.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),n=t.bbox(),i=U(e,n);if(null===i)return null;const s=this.leftSE.point,r=this.rightSE.point,o=t.leftSE.point,l=t.rightSE.point,h=D(e,o)&&0===this.comparePoint(o),u=D(n,s)&&0===t.comparePoint(s),a=D(e,l)&&0===this.comparePoint(l),f=D(n,r)&&0===t.comparePoint(r);if(u&&h)return f&&!a?r:!f&&a?l:null;if(u)return a&&s.x.eq(l.x)&&s.y.eq(l.y)?null:s;if(h)return f&&r.x.eq(o.x)&&r.y.eq(o.y)?null:o;if(f&&a)return null;if(f)return r;if(a)return l;const c=((t,e,n,i)=>{if(e.x.isZero())return H(n,i,t.x);if(i.x.isZero())return H(t,e,n.x);if(e.y.isZero())return Z(n,i,t.y);if(i.y.isZero())return Z(t,e,n.y);const s=F(e,i);if(s.isZero())return null;const r={x:n.x.minus(t.x),y:n.y.minus(t.y)},o=F(r,e).div(s),l=F(r,i).div(s),h=t.x.plus(l.times(e.x)),u=n.x.plus(o.times(i.x)),a=t.y.plus(l.times(e.y)),f=n.y.plus(o.times(i.y));return{x:h.plus(u).div(2),y:a.plus(f).div(2)}})(s,this.vector(),o,t.vector());return null===c?null:D(i,c)?z.snap(c):null}split(e){const n=[],i=void 0!==e.events,s=new Y(e,!0),r=new Y(e,!1),o=this.rightSE;this.replaceRightSE(r),n.push(r),n.push(s);const l=new t(s,o,this.rings.slice(),this.windings.slice());return Y.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Y.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(s.checkForConsuming(),r.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}consume(e){let n=this,i=e;for(;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const s=t.compare(n,i);if(0!==s){if(s>0){const t=n;n=i,i=t}if(n.prev===i){const t=n;n=i,i=t}for(let t=0,e=i.rings.length;t<e;t++){const e=i.rings[t],s=i.windings[t],r=n.rings.indexOf(e);-1===r?(n.rings.push(e),n.windings.push(s)):n.windings[r]+=s}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,l=this.rings.length;o<l;o++){const t=this.rings[o],i=this.windings[o],s=e.indexOf(t);-1===s?(e.push(t),n.push(i)):n[s]+=i}const s=[],r=[];for(let o=0,l=e.length;o<l;o++){if(0===n[o])continue;const t=e[o],i=t.poly;if(-1===r.indexOf(i))if(t.isExterior)s.push(i);else{-1===r.indexOf(i)&&r.push(i);const e=s.indexOf(t.poly);-1!==e&&s.splice(e,1)}}for(let o=0,l=s.length;o<l;o++){const t=s[o].multiPoly;-1===i.indexOf(t)&&i.push(t)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(et.type){case"union":{const n=0===t.length,i=0===e.length;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<e.length?(n=t.length,i=e.length):(n=e.length,i=t.length),this._isInResult=i===et.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2==1;break}case"difference":{const n=t=>1===t.length&&t[0].isSubject;this._isInResult=n(t)!==n(e);break}}return this._isInResult}},st=class{constructor(t,e,n){if(i(this,"poly"),i(this,"isExterior"),i(this,"segments"),i(this,"bbox"),!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const s=z.snap({x:new R(t[0][0]),y:new R(t[0][1])});this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};let r=s;for(let i=1,o=t.length;i<o;i++){if("number"!=typeof t[i][0]||"number"!=typeof t[i][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const e=z.snap({x:new R(t[i][0]),y:new R(t[i][1])});e.x.eq(r.x)&&e.y.eq(r.y)||(this.segments.push(it.fromRing(r,e,this)),e.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.x),e.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.y),e.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.x),e.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.y),r=e)}s.x.eq(r.x)&&s.y.eq(r.y)||this.segments.push(it.fromRing(r,s,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}},rt=class{constructor(t,e){if(i(this,"multiPoly"),i(this,"exteriorRing"),i(this,"interiorRings"),i(this,"bbox"),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new st(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=t.length;n<i;n++){const e=new st(t[n],this,!1);e.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.bbox.ur.y),this.interiorRings.push(e)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}},ot=class{constructor(t,e){if(i(this,"isSubject"),i(this,"polys"),i(this,"bbox"),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(n){}this.polys=[],this.bbox={ll:{x:new R(Number.POSITIVE_INFINITY),y:new R(Number.POSITIVE_INFINITY)},ur:{x:new R(Number.NEGATIVE_INFINITY),y:new R(Number.NEGATIVE_INFINITY)}};for(let i=0,s=t.length;i<s;i++){const e=new rt(t[i],this);e.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.bbox.ur.y),this.polys.push(e)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}};function lt(t,e={}){const n=[];if(o(t,t=>{n.push(t.coordinates)}),n.length<2)throw new Error("Must have at least 2 geometries");const i=((t,...e)=>et.run("union",t,e))(n[0],...n.slice(1));return 0===i.length?null:1===i.length?s(i[0],e.properties):r(i,e.properties)}z.set;var ht=lt;export{ht as default,lt as union};
