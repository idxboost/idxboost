import{r,y as e,A as $}from"./vendor-BZh8_evt.js";import{u as M}from"./state-in3dRHj9.js";import{u as A,a as R,b as _,n as I,d as L,e as T,f as P,g as B}from"./index-BZEBM8oo.js";import{u as k}from"./i18n-Dka-7LUO.js";const D=(t,m)=>{const a=r.useRef(null);return r.useEffect(()=>()=>{a.current&&clearTimeout(a.current)},[]),(...p)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{t(...p)},m)}},U="left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0",q=({url:t,additionalText:m="",image_url:a,description:c,openEmailForm:p})=>{const{t:u}=k(),[s,x]=r.useState(!1),y=D(()=>x(!1),2e3),b=async()=>{try{await navigator.clipboard.writeText(t),x(!0),y()}catch(h){console.error("Error copying link: ",h)}},o=h=>{const d=encodeURIComponent(t);let n="";switch(h){case"whatsapp":n=`https://api.whatsapp.com/send?text=${d}`;break;case"telegram":n=`https://t.me/share/url?url=${d}`;break;case"facebook":n=`https://www.facebook.com/sharer/sharer.php?u=${d}`;break;case"pinterest":{const l=encodeURIComponent(a),j=encodeURIComponent(c);n=`https://pinterest.com/pin/create/button/?url=${d}${l?`&media=${l}`:""}&description=${j}`;break}case"linkedin":n=`https://www.linkedin.com/sharing/share-offsite/?url=${d}`;break;case"x":{const l=encodeURIComponent(m);n=`https://x.com/intent/post?url=${d}${l?`&text=${l}`:""}`;break}default:console.error("Platform not supported");return}/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.location.href=n:window.open(n,"_blank",U)};return e.jsx("div",{className:"ms-sf-share-options",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Copy Link",onClick:b,children:[e.jsx("i",{className:"sf-icon-copy"}),e.jsxs("span",{children:[u("Copy Link")," ",s&&e.jsxs("span",{className:"ms-sf-label-copy",children:[u("Copied"),"!"]})]})]})}),!!p&&e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Email",onClick:p,children:[e.jsx("i",{className:"sf-icon-envelope"}),e.jsx("span",{children:u("Email")})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Facebook",onClick:()=>o("facebook"),children:[e.jsx("i",{className:"sf-icon-facebook-sp"}),e.jsx("span",{children:"Facebook"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"WhatsApp",onClick:()=>o("whatsapp"),children:[e.jsx("i",{className:"sf-icon-whatsapp"}),e.jsx("span",{children:"WhatsApp"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Linkedin",onClick:()=>o("linkedin"),children:[e.jsx("i",{className:"sf-icon-linkedin-sp"}),e.jsx("span",{children:"Linkedin"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"X",onClick:()=>o("x"),children:[e.jsx("i",{className:"sf-icon-twitter"}),e.jsx("span",{children:"X"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Telegram",onClick:()=>o("telegram"),children:[e.jsx("i",{className:"sf-icon-telegram"}),e.jsx("span",{children:"Telegram"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"ms-sf-btn -silver","aria-label":"Pinterest",onClick:()=>o("pinterest"),children:[e.jsx("i",{className:"sf-icon-pinterest-sp"}),e.jsx("span",{children:"Pinterest"})]})})]})})},Y=({mlsNumber:t,onClose:m})=>{const{t:a}=k(),{infoLead:c}=A(),{executeRecaptcha:p,isLoading:u}=R(),[s,{isLoading:x}]=_(),y=u||x,[b,o]=r.useState(""),[h,d]=r.useState(""),[n,f]=r.useState(c.email||""),[l,j]=r.useState(""),[N,w]=r.useState("");function v({name:i,lastName:g,email:E}){const S=`${i||""} ${g||""}`.trim();S&&j(S),E&&f(E)}const C=r.useCallback(()=>{o(""),d(""),v(c),w("")},[c]);r.useEffect(()=>{v(c)},[c]);async function F(i){i.preventDefault();try{const g=await p("submit");await s({targetEmail:b,sourceEmail:n,targetName:h,sourceName:l,comments:N,mlsNumber:t,recaptchaToken:g}).unwrap(),m?.(),C(),I({title:"Email Sent!",text:"Your email was sent successfully",type:"success",timer:2e3})}catch{I({title:"Email Sending Failed",text:"An error occurred while sending your email. Please try again later.",type:"error",showConfirmButton:!0})}}return e.jsxs("form",{className:"ms-sf-contact-form",onSubmit:F,children:[e.jsxs("div",{className:"ms-sf-wrapper-input",children:[e.jsxs("label",{htmlFor:"femail",children:[a("To"),"*"]}),e.jsx("input",{id:"femail",name:"femail",type:"email",placeholder:`${a("Recipient email")}*`,value:b,onChange:i=>o(i.target.value),required:!0})]}),e.jsxs("div",{className:"ms-sf-wrapper-input",children:[e.jsxs("label",{htmlFor:"Fname",children:[a("Name"),"*"]}),e.jsx("input",{id:"Fname",name:"Fname",type:"text",placeholder:`${a("Recipient name")}*`,value:h,onChange:i=>d(i.target.value),required:!0})]}),e.jsxs("div",{className:"ms-sf-wrapper-input",children:[e.jsxs("label",{htmlFor:"Yemail",children:[a("From"),"*"]}),e.jsx("input",{id:"Yemail",name:"Yemail",type:"email",placeholder:`${a("Enter your email")}*`,value:n,onChange:i=>f(i.target.value),required:!0})]}),e.jsxs("div",{className:"ms-sf-wrapper-input",children:[e.jsxs("label",{htmlFor:"Yname",children:[a("Name"),"*"]}),e.jsx("input",{id:"Yname",name:"Yname",type:"text",placeholder:`${a("Enter your full name")}*`,value:l,onChange:i=>j(i.target.value),required:!0})]}),e.jsxs("div",{className:"ms-sf-wrapper-input -full",children:[e.jsx("label",{htmlFor:"message",children:a("Message")}),e.jsx("textarea",{name:"message",id:"message",placeholder:a("Message"),value:N,onChange:i=>w(i.target.value)})]}),e.jsx("div",{className:"ms-sf-wrapper-input",children:e.jsxs("span",{className:"ms-sf-small-text",children:["* ",a("Required fields")]})}),e.jsxs("div",{className:"ms-sf-wrapper-btn -flex",children:[e.jsx("button",{className:"ms-sf-btn -silver -xl",type:"button",onClick:()=>{C(),m?.()},children:a("Cancel")}),e.jsx("button",{className:"ms-sf-btn -black -xl -full",type:"submit",disabled:y,children:a(y?"Loading...":"Continue")})]})]})},X=()=>{const{t}=k(),m=M(),[a,c]=r.useState(!1),[p,u]=r.useState(!1),[s,x]=r.useState(null);r.useEffect(()=>{const l=N=>{const v=N.detail;v&&(x(v),c(!0))},j=()=>{c(!1),x(null),u(!1)};return window.addEventListener(L,l),window.addEventListener(T,j),()=>{window.removeEventListener(L,l),window.removeEventListener(T,j)}},[m]);const b=document.getElementById("wpadminbar")?.offsetHeight||0,[o,h]=r.useState(!1),d=r.useCallback(()=>{h(!1),setTimeout(()=>{P()},300)},[m]),n=()=>{if(!s?.type)return t("Share");switch(s.type){case"building":return t("Share this Building");case"property":return t("Share this Property");default:return t("Share")}};if(r.useEffect(()=>{const l=document.querySelectorAll(".ms-sf-modal.active").length;if(!a&&!l){document.body.classList.remove("openModal");return}document.body.classList.add("openModal"),setTimeout(()=>h(!0),100)},[a]),!a||!s)return null;const f=document.getElementById("share-modal")||document.createElement("div");return f.id||(f.id="share-modal",document.body.appendChild(f)),$.createPortal(e.jsx("div",{className:`ms-sf-modal active ${o?"in":""}`,tabIndex:-1,role:"dialog",id:"shareModal",children:e.jsx("div",{className:"ms-sf-modal-dialog -md",role:"document",children:e.jsxs("div",{className:`ms-sf-modal-content ${o?"active":""}`,style:{top:b},children:[e.jsx("div",{className:"ms-sf-modal-header ms-sf-ct",children:e.jsx("div",{className:"ms-sf-flex",children:e.jsx("h5",{className:"ms-sf-title",children:n()})})}),e.jsxs("div",{className:"ms-sf-modal-body ms-sf-ct",children:[e.jsx("div",{className:"ms-sf-paragraph",children:p?e.jsx("p",{children:t("Recommend this to a friend, just enter their email below.")}):e.jsx("p",{children:t("Recommend this to a friend.")})}),e.jsxs("div",{className:"ms-sf-form",children:[e.jsxs("div",{className:"ms-sf-property-detail",children:[e.jsx("div",{className:"ms-sf-property-image",children:e.jsx(B,{url:s.image_url})}),e.jsxs("div",{className:"ms-sf-property-info",children:[s.type==="property"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ms-sf-property-price",children:s.propertyInfo?.price}),e.jsxs("div",{className:"ms-sf-property-detail",children:[s.propertyInfo?.commercialType?e.jsx("div",{className:"ms-sf-property-item",children:t(s.propertyInfo?.commercialType)}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"ms-sf-property-item",children:[e.jsx("strong",{children:s.propertyInfo?.beds})," ",s.propertyInfo?.beds===1?t("Bed"):t("Beds")]}),e.jsxs("div",{className:"ms-sf-property-item",children:[e.jsx("strong",{children:s.propertyInfo?.baths})," ",s.propertyInfo?.baths===1?t("Bath"):t("Baths")]})]}),e.jsxs("div",{className:"ms-sf-property-item",children:[e.jsx("strong",{children:s.propertyInfo?.area.value})," ",s.propertyInfo?.area.measurement]})]}),e.jsx("div",{className:"ms-sf-property-address",children:s.propertyInfo?.address_short}),e.jsx("div",{className:"ms-sf-property-address",children:s.propertyInfo?.address_large})]}),s.type==="building"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ms-sf-property-price",children:s.buildingInfo?.name}),e.jsx("div",{className:"ms-sf-property-address",children:s.full_address})]})]})]}),e.jsxs("div",{className:`ms-sf-wrapper-share-options ${p?"active":""}`,children:[e.jsx(q,{url:s.url,image_url:s.image_url,additionalText:s.additionalText,description:s.full_address,openEmailForm:s.type==="property"?()=>u(!0):void 0}),s.type==="property"&&!!s.propertyInfo&&e.jsx("div",{className:"ms-sf-form-hidden",children:e.jsx(Y,{mlsNumber:s.propertyInfo.mls_num,onClose:()=>u(!1)})})]})]})]}),e.jsx("button",{className:"ms-sf-btn -close-modal -circle -standard -sm js-close-st-modal","data-id":"#shareModal",onClick:d,children:e.jsx("i",{className:"sf-icon-close"})})]})})}),f)};export{X as default};
