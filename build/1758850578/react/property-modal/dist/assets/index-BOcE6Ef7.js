import{y as e,r as o,A as I}from"./vendor-BZh8_evt.js";import{u as L}from"./state-in3dRHj9.js";import{w as T,x as A,y as O,z as k,A as x,B as D,N as B,r as V,D as F,n as $}from"./index-BZEBM8oo.js";import{u as P}from"./i18n-Dka-7LUO.js";const q=({className:a="",options:d=[],selectedValues:c=[],name:i,onChange:m,required:h=!1})=>{const u=r=>{const t=c.includes(r.value.toString())?c.filter(n=>n!==r.value.toString()):[...c,r.value.toString()];m(t)};return e.jsx("ul",{className:`${a}`,children:d?.map((r,f)=>{const{label:t,value:n}=r;return e.jsx("li",{className:`${a}-item`,children:e.jsx(T,{id:`${i}_${n}`,label:t,name:i,onChange:()=>u(r),checked:c.includes(n.toString()),required:h&&!c.length})},`${n}_${f}`)})})},H=({options:a,value:d,prevText:c,inline:i,onChange:m,className:h=""})=>{const[u,r]=o.useState(d||a[0].value);o.useEffect(()=>{r(d||"")},[d]);function f(t){const n=t.target.value;r(n),m&&m(n)}return e.jsxs("div",{className:`${i?"ms-sf-sortBy-select":"ms-sf-wrapper-select"} ${h}`,children:[i&&c&&e.jsxs("label",{className:"ms-sf-label",children:[c," ",e.jsx("strong",{children:a?.find(t=>t.value===u)?.label})]}),e.jsx("select",{className:"ms-sf-select",value:u,onChange:f,children:a?.map(({value:t,label:n},v)=>e.jsx("option",{value:t,children:n},`${t}_${v}`))})]})},J=()=>{const{t:a}=P(),d=window.paramsMapSearch?.params?.name,c=L(),[i,m]=o.useState(!1),[h,u]=o.useState(null);o.useEffect(()=>{const s=S=>{const C=S.detail;!C||!V()||(u(C),m(!0))},l=()=>{m(!1),u(null)};return window.addEventListener(A,s),window.addEventListener(O,l),()=>{window.removeEventListener(A,s),window.removeEventListener(O,l)}},[c]);const f=document.getElementById("wpadminbar")?.offsetHeight,[t,n]=o.useState(!1),[v]=k(),[N,j]=o.useState(d||""),[b,E]=o.useState("1"),[w,g]=o.useState(x.map(({value:s})=>`${s}`)),y=o.useCallback(()=>{n(!1),setTimeout(()=>{D()},300)},[c]);if(o.useEffect(()=>{document.body.classList.remove("openModal"),i&&(document.body.classList.add("openModal"),setTimeout(()=>n(!0),100))},[i]),!i)return null;const p=document.getElementById("save-modal")||document.createElement("div");p.id||(p.id="save-modal",document.body.appendChild(p));function M(){j(d||""),E("1");const s=x.map(({value:l})=>`${l}`);g(s)}async function _(s){if(h)try{s.preventDefault();const l={searchName:N.trim(),notificationDay:b,alertOptions:w,...h},S=await v(l).unwrap();F("saved_searches"),y(),M(),$({title:"Search Saved!",text:S.message,type:"success",timer:2e3})}catch(l){$({title:"Oops...",text:l.message,type:"error",showConfirmButton:!0})}}return I.createPortal(e.jsx("div",{className:`ms-sf-modal active ${t?"in":""}`,tabIndex:-1,role:"dialog",id:"saveSearch",children:e.jsx("div",{className:"ms-sf-modal-dialog -sm",role:"document",children:e.jsxs("div",{className:`ms-sf-modal-content ${t?"active":""}`,style:{top:f},children:[e.jsx("div",{className:"ms-sf-modal-header ms-sf-ct",children:e.jsx("div",{className:"ms-sf-flex",children:e.jsx("h5",{className:"ms-sf-title",children:a("Save Search")})})}),e.jsxs("div",{className:"ms-sf-modal-body ms-sf-ct",children:[e.jsx("div",{className:"ms-sf-paragraph",children:e.jsx("p",{children:a("You will receive automatic updates every time there are new listings and price reductions.")})}),e.jsx("div",{className:"ms-sf-form",children:e.jsxs("form",{className:"ms-sf-contact-form",onSubmit:_,children:[e.jsxs("div",{className:"ms-sf-wrapper-input -full",children:[e.jsxs("label",{htmlFor:"ib-name-search",children:[a("Name Your Search"),"*"]}),e.jsx("input",{id:"ib-name-search",name:"search_name",type:"text",placeholder:a("Enter a search name"),value:N,required:!0,onChange:({target:s})=>j(s.value||"")})]}),e.jsxs("div",{className:"ms-sf-wrapper-input -full",children:[e.jsx("label",{htmlFor:"ib-notification-day",children:a("Email Updates")}),e.jsx(H,{options:B.map(({label:s,value:l})=>({label:a(s),value:l})),value:b,onChange:s=>E(`${s}`)})]}),e.jsx(q,{name:"alert-options",className:"ms-sf-chk-inner-list",options:x.map(({label:s,value:l})=>({label:a(s),value:l})),selectedValues:w,onChange:s=>g(s),required:!0}),e.jsx("div",{className:"ms-sf-wrapper-btn",children:e.jsx("button",{className:"ms-sf-btn -black -xl -full",type:"submit",children:a("Continue")})})]})})]}),e.jsx("button",{className:"ms-sf-btn -close-modal -circle -standard -sm js-close-st-modal","data-id":"#saveSearch",onClick:y,children:e.jsx("i",{className:"sf-icon-close"})})]})})}),p)};export{J as default};
