import{r as e,z as t,u as n,a as r,b as a,c as o,R as l,F as s,d as i,C as c,e as m,f as d,A as u,g as p,h as _,i as f}from"./vendor.js";import{U as y}from"./phone-input-e0238ad8.js";const g="_form-wizard_19yly_2",h={user:{},api:{idxboost:"https://api.idxboost.dev"},apiKey:{googleMaps:"AIzaSyBU6VY2oHfII-RPAcZZu9qq843bpE3pLNo"},form:{type:window.idx_buy_sell_rent_forms?.form_type||"sell",accessToken:window.idx_buy_sell_rent_forms?.access_token||"ZGViN2ExN2ExYjgyZDk1MjAxNGZiOWEzNWQ4Yzg0YjNlY2E3MjU4NzU0ZDIwOGFiNmE4ZDdkYThhMTk0Mzk4NA",leadToken:window.idx_buy_sell_rent_forms?.lead_token||"",firstName:window.idx_buy_sell_rent_forms?.lead.name||"",lastName:window.idx_buy_sell_rent_forms?.lead.lastname||"",email:window.idx_buy_sell_rent_forms?.lead.email||"",phone:window.idx_buy_sell_rent_forms?.lead.new_phone||""}};var E=Object.defineProperty;class b{constructor(){var e,t,n;e=this,t="baseUrl",n=`${h.api.idxboost}/idxforms`,((e,t,n)=>{t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n)}buildQuery(e){const t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{null!=n&&t.append(e,String(n))}),t.toString()}async getById({id:e}){const t=await fetch(`${this.baseUrl}/${e}`);if(!t.ok)throw new Error("Error fetching idxform by ID");return t.json()}async getBySlug({slug:e,accessToken:t}){const n=new FormData;n.append("access_token",t);const r=await fetch(`${this.baseUrl}/slug-rk/${e}`,{method:"POST",body:n});if(!r.ok)throw new Error("Error fetching idxform by slug");return r.json()}async getIpLead(){try{const e=await fetch(`${h.api.idxboost}/get/ip_lead`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok)throw new Error(`Error fetching IP lead: ${e.status}`);return e.json()}catch(e){return console.error("Error fetching IP lead:",e),null}}async sendIdxForm({client_ip:e,origin:t,referer:n,agent:r,access_token:a,lead_token:o,form_data:l,autologinForms:s}){if(!e){const t=await this.getIpLead();e=t?.ip||"",l.country_code=t?.country||""}const i={client_ip:e,origin:t,referer:n,agent:r,access_token:a,lead_token:o,form_data:JSON.stringify(l),autologinForms:s},c=new FormData;Object.entries(i).forEach(([e,t])=>{c.append(e,String(t))});const m=await fetch(`${this.baseUrl}/handle`,{method:"POST",body:c});if(!m.ok){const e=await m.text();throw new Error(`Error sending idxform: ${e}`)}return m.json()}}var w=(e=>(e.SelectSingle="select_single",e.MultiSelect="multi_select",e.Contact="contact",e.Text="text",e.Address="address",e.Beds="beds",e.Baths="baths",e.Price="price",e.PropertyType="property_type",e))(w||{});function v({title:e,type:t,showConfirmButton:n=!1,text:r,timer:a,button:o}){return swal({title:e,text:r,icon:t,timer:a,button:o??n})}const k=t.object({first_name:t.string().min(1,"First name is required"),last_name:t.string().min(1,"Last name is required"),email:t.string().min(1,"Email is required").email("Invalid email"),phone:t.string().min(1,"Phone is required").regex(/^\+\d{7,15}$/,"Invalid phone number"),comments:t.string().optional(),questions:t.array(t.object({question:t.string(),questionType:t.enum(["address","select_single","multi_select","text","contact","beds","baths","price","property_type"]),answer:t.string().optional(),options:t.array(t.union([t.string(),t.object({label:t.string(),value:t.string()})])).optional().default([]),placeholder:t.string().optional(),lat:t.number().optional(),lng:t.number().optional()}).refine(e=>"contact"===e.questionType||null!=e.answer&&e.answer.trim().length>0,{message:"This field is required",path:["answer"]}))}),N=({mode:t="fullpage",formSlug:i,onClose:c}={})=>{const m=e.useMemo(()=>new b,[]),[d,u]=e.useState(null),[p,_]=e.useState("us"),f=i||h.form.type,{accessToken:y,leadToken:E,firstName:N,lastName:x,email:C,phone:q}=h.form,S=n({resolver:r(k),defaultValues:{questions:[]}}),{handleSubmit:$,control:P,reset:O,trigger:j,formState:{errors:B}}=S,{fields:D}=a({control:P,name:"questions"}),[z,U]=e.useState(0),[W,Z]=e.useState(null),V=D[z],G=z===(D?.length&&D.length-1),K=0===z,J="modal"===t,Q=d?.background_image,X=J?`${g} _form-wizard--modal_19yly_104`:g,H=o({control:P,name:`questions.${z}.answer`});return e.useEffect(()=>{f&&m.getBySlug({slug:f,accessToken:y}).then(e=>u(e)).catch(e=>console.error("Error loading form:",e))},[f,y]),e.useEffect(()=>{m.getIpLead().then(e=>{e?.country&&_(e.country.toLowerCase())}).catch(e=>console.error("Error fetching IP lead:",e))},[]),e.useEffect(()=>{d?.steps&&O({questions:d.steps.map(e=>({...e,answer:"",lat:void 0,lng:void 0})),first_name:N??"",last_name:x??"",email:C??"",phone:q??"",comments:""})},[d?.steps]),d&&V?l.createElement(s,{...S},l.createElement("form",{className:X,onSubmit:e=>e.preventDefault()},!J&&l.createElement("div",{className:"_form-background_19yly_9",style:{backgroundImage:`url(${Q})`}}),l.createElement("div",{className:"_form-content_19yly_33"},l.createElement("div",{className:"_step-container_19yly_42"},l.createElement("div",{className:"_back-button-container_19yly_81"},!K&&l.createElement(R,{onClick:()=>U(e=>e-1),iconOnly:J}))," ",l.createElement("div",{className:"_step-content_19yly_51"},l.createElement("div",{className:"_step-header_19yly_67"},l.createElement(M,{question:V.question,subtitle:"contact"===V.questionType?"Please provide your contact information below and we will be in touch very soon!":""})),(V.questionType===w.SelectSingle||V.questionType===w.Beds||V.questionType===w.Baths||V.questionType===w.Price||V.questionType===w.PropertyType)&&l.createElement(L,{name:`questions.${z}.answer`,options:V.options??[]}),V.questionType===w.Address&&l.createElement(Y,{name:`questions.${z}.answer`}),V.questionType===w.Text&&l.createElement(T,{name:`questions.${z}.answer`,placeholder:V.placeholder}),V.questionType===w.MultiSelect&&l.createElement(F,{name:`questions.${z}.answer`,options:V.options??[]}),V.questionType===w.Contact&&l.createElement(I,{defaultCountry:p}),l.createElement("div",{className:"_navigation-buttons_19yly_73"},l.createElement(A,{disabled:!(G||H&&""!==H.trim()),onClick:G?$(async e=>{const t=e.questions.filter(e=>e.questionType!==w.Contact),n={formType:f,steps:t.map(e=>({question:e.question,answer:e.answer,...e.questionType===w.Address&&e.lat&&e.lng?{lat:e.lat,lng:e.lng}:{}})),contact:{name:`${e.first_name} ${e.last_name}`,email:e.email,phone:e.phone,comments:e.comments}};Z(n),e.steps=e.questions.filter(e=>"contact"!==e.questionType).map(e=>({question:e.question,answer:e.answer})),delete e.questions,e.name=`${e.first_name} ${e.last_name}`,delete e.first_name,delete e.last_name;try{const n=await m.sendIdxForm({agent:window.navigator.userAgent,form_data:e,origin:window.origin,referer:document.referrer,access_token:y,lead_token:E,autologinForms:!1});if(n.success){const e=d?.redirect_on_submit??!0,n=d?.redirect_url??"/search";O(),U(0),J&&c&&c(),v({title:"Thank You!",text:d?.redirect_message??"Your information has been submitted successfully. We'll be in touch with you shortly.",type:"success",timer:1500}),e&&setTimeout(()=>{const e=((e,t)=>{const n=new URLSearchParams;return t&&("buy"===t?n.set("for","sale"):"sell"===t?(n.set("for","sold"),n.set("lookup_previous_sold","month-3")):n.set("for",t)),e.forEach(e=>{switch(e.questionType){case w.Beds:n.set("beds",e.answer.replace(/_/g,"-").replace(/-$/,""));break;case w.Baths:n.set("baths",e.answer.replace(/_/g,"-").replace(/-$/,""));break;case w.Price:n.set("price",e.answer);break;case w.PropertyType:n.set("property_type",e.answer);break;case w.Address:e.lat&&e.lng&&n.set("radius_location",`${e.lat},${e.lng},1`)}}),n})(t,d?.form_type);window.location.href=`${n}?${e.toString()}`},1500)}else console.error("[FormWizard] API returned success=false:",n),v({title:"Error",text:n.message||"Something went wrong",type:"error",showConfirmButton:!0})}catch(r){console.error("[FormWizard] Submit error:",r),v({title:"Error",text:r instanceof Error?r.message:"Something went wrong",type:"error",showConfirmButton:!0})}},e=>{console.error("[FormWizard] Validation errors:",e)}):async()=>{await j(`questions.${z}.answer`)&&U(e=>e+1)}},G?"Submit":"Continue"))))))):null},x="_form-row_11vhv_8",C="_link_11vhv_18",q="_field-phone_63hip_15",S=({name:e,label:t,placeholder:n,defaultCountry:r="us"})=>{const{control:a}=i();return l.createElement("div",{className:"_field-group_63hip_2"},t&&l.createElement("label",{className:"_field-label_63hip_6"},t),l.createElement(c,{name:e,control:a,rules:{required:"Phone is required"},render:({field:e,fieldState:t})=>l.createElement(l.Fragment,null,l.createElement(y,{defaultCountry:r,placeholder:n,value:e.value||"",onChange:e.onChange,inputClassName:`${q} _field-phone__input_63hip_29`,countrySelectorStyleProps:{buttonClassName:`${q} _field-phone__country_63hip_26`}}),t.error&&l.createElement("div",{className:"_field-error_63hip_47"},t.error.message))}))},$={"field-label":"_field-label_1p0yg_2","field-input":"_field-input_1p0yg_11","field-error":"_field-error_1p0yg_33","contact-textarea":"_contact-textarea_1p0yg_39"},T=({name:e,label:t,placeholder:n})=>{const{control:r}=i(),{field:a,fieldState:{error:o}}=m({name:e,control:r});return l.createElement("div",{className:$["field-group"]},t&&l.createElement("label",{className:$["field-label"]},t),l.createElement("input",{type:"text",className:$["field-input"],placeholder:n,...a}),o&&l.createElement("div",{className:$["field-error"]},o.message))},P=({name:e,label:t,placeholder:n})=>{const{control:r}=i(),{field:a,fieldState:{error:o}}=m({name:e,control:r});return l.createElement("div",{className:$["field-group"]},t&&l.createElement("label",{className:$["field-label"]},t),l.createElement("textarea",{className:`${$["field-input"]} ${$["contact-textarea"]}`,placeholder:n,...a}),o&&l.createElement("div",{className:$["field-error"]},o.message))},I=({defaultCountry:e})=>l.createElement("div",{className:"_contact-form_11vhv_2"},l.createElement("div",{className:x},l.createElement(T,{name:"first_name",placeholder:"First Name *"}),l.createElement(T,{name:"last_name",placeholder:"Last Name *"})),l.createElement("div",{className:x},l.createElement(S,{name:"phone",placeholder:"Phone *",defaultCountry:e}),l.createElement(T,{name:"email",placeholder:"Email *"})),l.createElement("div",{className:`${x} _full_11vhv_14`},l.createElement(P,{name:"comments",placeholder:"Comments"})),l.createElement("div",{style:{display:"flex",gap:"10px",fontSize:"10px"}},l.createElement("input",{type:"checkbox",style:{transform:"scale(1.5)"}})," ",l.createElement("p",{className:"_agreement_text_11vhv_22"},"I agree to be contacted by test via call, email, and text for real estate services. To opt out, you can reply 'stop' at any time or reply 'help' for assistance. You can also click the unsubscribe link in the emails. Message and data rates may apply. Message frequency may vary."," ",l.createElement("a",{className:C,href:"https://google.com"},"Privacy Policy")," ","and"," ",l.createElement("a",{className:C,href:"https://google.com"},"Terms of Service"),"."))),O="_options-grid_1xs3s_2",j="_option-button_1xs3s_9",B="_selected_1xs3s_30",L=({name:e,options:t})=>{const{control:n}=i(),r=e=>"string"==typeof e?e:e.value;return l.createElement(c,{name:e,control:n,render:({field:e})=>l.createElement("div",{className:O},t.map(t=>l.createElement("button",{key:r(t),type:"button",className:`${j} ${e.value===r(t)?B:""}`,onClick:()=>e.onChange(r(t))},(e=>"string"==typeof e?e:e.label)(t))))})},F=({name:e,options:t})=>{const{control:n}=i(),r=e=>"string"==typeof e?e:e.value;return l.createElement(c,{name:e,control:n,render:({field:e})=>{const n=e.value?e.value.split(",").filter(Boolean):[];return l.createElement("div",{className:O},t.map(t=>l.createElement("button",{key:r(t),type:"button",className:`${j} ${n.includes(r(t))?B:""}`,onClick:()=>(t=>{const r=n.includes(t)?n.filter(e=>e!==t):[...n,t];e.onChange(r.join(","))})(r(t))},(e=>"string"==typeof e?e:e.label)(t))))}})},M=({question:e,subtitle:t})=>l.createElement(l.Fragment,null,l.createElement("h1",{className:"_step-question_1bter_1"},e),t&&l.createElement("p",{className:"_step-subtitle_1bter_8"},t)),A=({onClick:e=()=>{},disabled:t,children:n})=>l.createElement("button",{className:"_form-button_1qdj5_2",onClick:e,disabled:t,type:"button"},n),D=["places"],z=e.createContext({isLoaded:!1}),U=({children:e})=>{const{isLoaded:t}=d({googleMapsApiKey:h.apiKey.googleMaps,libraries:D});return l.createElement(z.Provider,{value:{isLoaded:t}},e)},Y=({name:t})=>{const{setValue:n}=i(),{isLoaded:r}=e.useContext(z),[a,o]=e.useState(null);return r?l.createElement(u,{onLoad:e=>{o(e)},onPlaceChanged:()=>{if(null!==a){const e=a.getPlace();if(!e.geometry||!e.geometry.location)return;const r=e.formatted_address||"",o=e.geometry.location.lat(),l=e.geometry.location.lng();n(t,r,{shouldDirty:!0}),n(t.replace(".answer",".lat"),o,{shouldDirty:!0}),n(t.replace(".answer",".lng"),l,{shouldDirty:!0})}},options:{types:["address"]}},l.createElement(T,{name:t,label:"Property Address *",placeholder:"Enter your address here"})):l.createElement(T,{name:t,label:"Property Address *",placeholder:"Enter your address here"})},W="_nav-button_19cu6_1",Z="_back_19cu6_16",R=({onClick:e=()=>{},iconOnly:t=!1})=>{const n=t?`${W} ${Z} _icon-only_19cu6_25`:`${W} ${Z}`;return l.createElement("button",{className:n,type:"button",onClick:e},l.createElement(p,null),!t&&l.createElement("span",null,"Back"))},V=({children:t,containerId:n="idx-modal-root"})=>{const[r,a]=e.useState(null);return e.useEffect(()=>{let e=document.getElementById(n);return e||(e=document.createElement("div"),e.id=n,document.body.appendChild(e)),a(e),()=>{e&&e.parentNode&&!e.hasChildNodes()&&e.parentNode.removeChild(e)}},[n]),r?_.createPortal(t,r):null},G=({isOpen:t,onClose:n,children:r,closeOnOverlayClick:a=!0,closeOnEsc:o=!0,className:s=""})=>{const i=e.useRef(null),c=e.useRef(null),m=e.useCallback(e=>{o&&"Escape"===e.key&&n()},[o,n]),d=e.useCallback(e=>{a&&e.target===e.currentTarget&&n()},[a,n]);return e.useEffect(()=>(t&&(c.current=document.activeElement,document.addEventListener("keydown",m),document.body.style.overflow="hidden",i.current?.focus()),()=>{document.removeEventListener("keydown",m),document.body.style.overflow="",c.current?.focus()}),[t,m]),t?l.createElement(V,null,l.createElement("div",{className:"_modal-overlay_hf8iw_1",onClick:d,role:"dialog","aria-modal":"true"},l.createElement("div",{ref:i,className:`_modal-container_hf8iw_27 ${s}`,tabIndex:-1},l.createElement("button",{className:"_modal-close_hf8iw_51",onClick:n,"aria-label":"Close modal"},l.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},l.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))),r))):null},K=({isOpen:e,onClose:t,formSlug:n})=>e?l.createElement(G,{isOpen:e,onClose:t},l.createElement(U,null,l.createElement(N,{mode:"modal",formSlug:n,onClose:t}))):null;let J=null,Q={isOpen:!1,formSlug:""};function X(){J&&J.render(l.createElement(K,{isOpen:Q.isOpen,formSlug:Q.formSlug,onClose:te}))}function H(){if(J)return;let e=document.getElementById("idx-modal-provider-root");e||(e=document.createElement("div"),e.id="idx-modal-provider-root",document.body.appendChild(e)),J=f(e),X()}function ee(e){J||(console.error("[IDX Forms] Modal system not initialized. Call initModalSystem() first."),H()),Q={isOpen:!0,formSlug:e},X()}function te(){Q={...Q,isOpen:!1},X()}function ne(){const e=e=>{const t=e.target.closest("[data-idx-modal]");if(!t)return;const n=t.getAttribute("data-idx-modal");n&&(e.preventDefault(),ee(n))};return document.addEventListener("click",e,!0),()=>document.removeEventListener("click",e,!0)}const re={init:H,openModal:ee,closeModal:te,setupListeners:ne},ae=document.getElementById("root-dinamic-forms");ae&&f(ae).render(l.createElement(l.StrictMode,null,l.createElement(U,null,l.createElement(N,null)))),H(),ne(),window.IDXForms=re;
