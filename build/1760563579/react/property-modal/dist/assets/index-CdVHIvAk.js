import{j as e,p as s,q as a,A as t,s as l,r as n,N as i,l as r,t as c,n as o}from"./bootstrap-D1xkZDE8.js";import{r as m,u as d}from"./i18n-D0PRNWcO.js";import{u}from"./state-BCq8qzba.js";import{j as h,e as p}from"./index-BpLq4uhv.js";const f=({className:a="",options:t=[],selectedValues:l=[],name:n,onChange:i,required:r=!1})=>e.jsx("ul",{className:`${a}`,children:t?.map((t,c)=>{const{label:o,value:m}=t;return e.jsx("li",{className:`${a}-item`,children:e.jsx(s,{id:`${n}_${m}`,label:o,name:n,onChange:()=>(e=>{const s=l.includes(e.value.toString())?l.filter(s=>s!==e.value.toString()):[...l,e.value.toString()];i(s)})(t),checked:l.includes(m.toString()),required:r&&!l.length})},`${m}_${c}`)})}),v=({options:s,value:a,prevText:t,inline:l,onChange:n,className:i=""})=>{const[r,c]=m.useState(a||s[0].value);return m.useEffect(()=>{c(a||"")},[a]),e.jsxs("div",{className:`${l?"ms-sf-sortBy-select":"ms-sf-wrapper-select"} ${i}`,children:[l&&t&&e.jsxs("label",{className:"ms-sf-label",children:[t," ",e.jsx("strong",{children:s?.find(e=>e.value===r)?.label})]}),e.jsx("select",{className:"ms-sf-select",value:r,onChange:function(e){const s=e.target.value;c(s),n&&n(s)},children:s?.map(({value:s,label:a},t)=>e.jsx("option",{value:s,children:a},`${s}_${t}`))})]})},x=()=>{const{t:s}=d(),x=window.paramsMapSearch?.params?.name,j=u(),[b,N]=m.useState(!1),[g,w]=m.useState(null);m.useEffect(()=>{const e=e=>{const s=e.detail;s&&r()&&(w(s),N(!0))},s=()=>{N(!1),w(null)};return window.addEventListener(h,e),window.addEventListener(p,s),()=>{window.removeEventListener(h,e),window.removeEventListener(p,s)}},[j]);const S=document.getElementById("wpadminbar"),y=S?.offsetHeight,[$,C]=m.useState(!1),[E]=a(),[L,k]=m.useState(x||""),[q,_]=m.useState("1"),[B,I]=m.useState(t.map(({value:e})=>`${e}`)),M=m.useCallback(()=>{C(!1),setTimeout(()=>{l()},300)},[j]);if(m.useEffect(()=>{document.body.classList.remove("openModal"),b&&(document.body.classList.add("openModal"),setTimeout(()=>C(!0),100))},[b]),!b)return null;const T=document.getElementById("save-modal")||document.createElement("div");return T.id||(T.id="save-modal",document.body.appendChild(T)),n.createPortal(e.jsx("div",{className:"ms-sf-modal active "+($?"in":""),tabIndex:-1,role:"dialog",id:"saveSearch",children:e.jsx("div",{className:"ms-sf-modal-dialog -sm",role:"document",children:e.jsxs("div",{className:"ms-sf-modal-content "+($?"active":""),style:{top:y},children:[e.jsx("div",{className:"ms-sf-modal-header ms-sf-ct",children:e.jsx("div",{className:"ms-sf-flex",children:e.jsx("h5",{className:"ms-sf-title",children:s("Save Search")})})}),e.jsxs("div",{className:"ms-sf-modal-body ms-sf-ct",children:[e.jsx("div",{className:"ms-sf-paragraph",children:e.jsx("p",{children:s("You will receive automatic updates every time there are new listings and price reductions.")})}),e.jsx("div",{className:"ms-sf-form",children:e.jsxs("form",{className:"ms-sf-contact-form",onSubmit:async function(e){if(g)try{e.preventDefault();const s={searchName:L.trim(),notificationDay:q,alertOptions:B,...g},a=await E(s).unwrap();c("saved_searches"),M(),function(){k(x||""),_("1");const e=t.map(({value:e})=>`${e}`);I(e)}(),o({title:"Search Saved!",text:a.message,type:"success",timer:2e3})}catch(s){o({title:"Oops...",text:s.message,type:"error",showConfirmButton:!0})}},children:[e.jsxs("div",{className:"ms-sf-wrapper-input -full",children:[e.jsxs("label",{htmlFor:"ib-name-search",children:[s("Name Your Search"),"*"]}),e.jsx("input",{id:"ib-name-search",name:"search_name",type:"text",placeholder:s("Enter a search name"),value:L,required:!0,onChange:({target:e})=>k(e.value||"")})]}),e.jsxs("div",{className:"ms-sf-wrapper-input -full",children:[e.jsx("label",{htmlFor:"ib-notification-day",children:s("Email Updates")}),e.jsx(v,{options:i.map(({label:e,value:a})=>({label:s(e),value:a})),value:q,onChange:e=>_(`${e}`)})]}),e.jsx(f,{name:"alert-options",className:"ms-sf-chk-inner-list",options:t.map(({label:e,value:a})=>({label:s(e),value:a})),selectedValues:B,onChange:e=>I(e),required:!0}),e.jsx("div",{className:"ms-sf-wrapper-btn",children:e.jsx("button",{className:"ms-sf-btn -black -xl -full",type:"submit",children:s("Continue")})})]})})]}),e.jsx("button",{className:"ms-sf-btn -close-modal -circle -standard -sm js-close-st-modal","data-id":"#saveSearch",onClick:M,children:e.jsx("i",{className:"sf-icon-close"})})]})})}),T)};export{x as default};
