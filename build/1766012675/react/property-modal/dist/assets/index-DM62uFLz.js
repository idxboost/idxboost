import{f as e,a,g as s,h as t,M as i,j as o,i as l,k as n,l as d,r,I as c,m,P as p,V as u,o as v,p as f,q as h,s as j}from"./bootstrap-DDEfgWWm.js";import{u as x}from"./state-DCJ-GHTM.js";import{r as b,u as y}from"./i18n-CBvvWIm0.js";import{g as w,c as N}from"./index-ByApUN5x.js";import"./phone-input-DMd9JE98.js";const g=({typeView:n,onChangeTypeView:d,onlyVisualizer:r=!1,property:c,handleFavorite:m,handleOpenContact:p,handleOpenShare:u,handleCloseModal:v})=>{const{isFavorite:f,selectedPropertyMLS:h}=e(),{favoriteIcon:j}=a(),{data:x}=s({mls_num:h},{skip:!h}),{width:y}=t(),w=b.useMemo(()=>{if(y&&y<i.TABLET)return!0},[y])||r;return o.jsx("div",{className:"ms-sf-modal-header",children:o.jsxs("div",{className:"ms-sf-flex",children:[o.jsx("h3",{className:"ms-sf-title ms-sf-ellipsis",children:!w&&c&&o.jsxs(o.Fragment,{children:[c.address_short,o.jsx("span",{children:c.address_large})]})}),o.jsxs("div",{className:"ms-sf-action-buttons",children:[!l&&!w&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -favorite "+(f?"active":""),"aria-label":"Favorite",type:"button","data-tool":"tooltip","data-tool-detail":"Save","data-tool-position":"bottom",onClick:e=>{e.stopPropagation(),m?.()},children:o.jsx("i",{className:`sf-icon-${j}`})})}),!w&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard "+("view-slider"===n?"active":""),"aria-label":"Photos","data-tool":"tooltip","data-tool-detail":"Photos","data-tool-position":"bottom","data-view":"view-slider","data-parent":"#fullScreenMediaContent",onClick:()=>d("view-slider"),children:o.jsx("i",{className:"sf-icon-camera"})})}),!w&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard "+("view-map"===n?"active":""),"aria-label":"Map","data-tool":"tooltip","data-tool-detail":"Map","data-tool-position":"bottom","data-view":"view-map","data-parent":"#fullScreenMediaContent",onClick:()=>d("view-map"),children:o.jsx("i",{className:"sf-icon-map"})})}),!w&&!!x?.url_video&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard "+("view-video"===n?"active":""),"aria-label":"Video","data-tool":"tooltip","data-tool-detail":"Video","data-tool-position":"bottom","data-view":"view-video","data-parent":"#fullScreenMediaContent",onClick:()=>d("view-video"),children:o.jsx("i",{className:"sf-icon-play"})})}),!l&&!w&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard","aria-label":"Contact Agent","data-id":"#contactModal","data-tool":"tooltip","data-tool-detail":"Contact Agent","data-tool-position":"bottom",onClick:p,children:o.jsx("i",{className:"sf-icon-envelope-active"})})}),!l&&!w&&o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard","data-id":"#shareModal","aria-label":"Share","data-tool":"tooltip","data-tool-detail":"Share","data-tool-position":"bottom",onClick:u,children:o.jsx("i",{className:"sf-icon-shared"})})}),o.jsx("div",{className:"ms-sf-item",children:o.jsx("button",{className:"ms-sf-btn -circle -standard js-close-st-modal","data-id":"#galleryModal","aria-label":"Close Modal","data-tool":"tooltip","data-tool-detail":"Close","data-tool-position":"bottom",onClick:v,children:o.jsx("i",{className:"sf-icon-close"})})})]})]})})},C=()=>{const e=x(),{t:a}=y(),{width:l}=t(),C=b.useMemo(()=>{if(l&&l<i.TABLET)return!0},[l])&&/iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,M=document.getElementById("wpadminbar"),_=M?.offsetHeight,[S,V]=b.useState(!1),[k,E]=b.useState(null),[T]=n(),[I,P]=b.useState(!1),[L,A]=b.useState(k?.initialTypeView||"view-slider"),{data:F}=s({mls_num:k?.property?.mls_num||""},{skip:!k?.property?.mls_num}),z=!!F?.url_video;b.useEffect(()=>{const e=e=>{const a=e.detail;a&&(E(a),A(a.initialTypeView||"view-slider"),V(!0))},a=()=>{V(!1),E(null)};return window.addEventListener(w,e),window.addEventListener(N,a),()=>{window.removeEventListener(w,e),window.removeEventListener(N,a)}},[e]);const B=b.useCallback(()=>{P(!1),A("view-slider"),setTimeout(()=>{d()},300)},[e]);if(b.useEffect(()=>{S&&setTimeout(()=>P(!0),100)},[S]),!S||!k)return null;const O=document.getElementById("gallery-modal")||document.createElement("div");return O.id||(O.id="gallery-modal",document.body.appendChild(O)),r.createPortal(o.jsx("div",{className:"ms-sf-modal active "+(I?"in":""),tabIndex:-1,role:"dialog",id:"galleryModal",children:o.jsx("div",{className:"ms-sf-modal-dialog",role:"document",children:o.jsxs("div",{className:"ms-sf-modal-content "+(I?"active":""),style:{top:_},children:[o.jsx(g,{typeView:L,onChangeTypeView:e=>A(e),onlyVisualizer:k.onlyVisualizer,property:k.property,handleFavorite:function(){k?.property&&j()&&T(k?.property.mls_num)},handleOpenContact:function(){e(h(!0))},handleOpenShare:function(){if(!k?.property)return;const e=v(k?.property,a);f(e)},handleCloseModal:B}),o.jsx("div",{className:"ms-sf-modal-body",children:o.jsxs("div",{className:`ms-sf-media ${L}`,id:"fullScreenMediaContent",children:[o.jsx("div",{className:"ms-sf-wrapper-slider",children:k.image_urls&&o.jsx(c,{thumbnail:k.image_urls[0],images:k.image_urls,showControls:!0,selectedItem:k.selected_image_pos,infiniteLoop:!0})}),!k.onlyVisualizer&&o.jsx("div",{className:"ms-sf-wrapper-map",children:o.jsx(b.Suspense,{fallback:null,children:o.jsx(m,{strategy:"onInteraction",enabled:!0,children:o.jsx(p,{lat:Number(k.property?.lat),lng:Number(k.property?.lng),address:k.property?.address_large||"",id:"propertyViewerMapGallery"})})})}),o.jsx("div",{className:"ms-sf-wrapper-video",children:z&&o.jsx(u,{videoUrl:F.url_video,autoplay:!0,controls:!0,muted:C,loop:!1,playsInline:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})})]})})]})})}),O)};export{C as default};
