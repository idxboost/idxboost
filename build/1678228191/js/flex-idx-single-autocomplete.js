!function(l){function e(e){e.preventDefault();var t=p.val();if(""!==t)if(p.autocomplete("close"),19==__flex_g_settings.boardId){for(var o=0,n=m.length;o<n;o++){var l=m[o];if(!1!==new RegExp("^"+l.label+"$","i").test(t)){a=l;break}}void 0!==a?u(a.label,"city"):u(t,null)}else if(/^\d+$/.test(t)&&5===t.length)u(t,"zip");else{for(var a,o=0,n=m.length;o<n;o++){l=m[o];if(!1!==new RegExp("^"+l.label+"$","i").test(t)){a=l;break}}void 0!==a?u(a.label,"city"):u(t,null)}}function i(e,t){var o=e.term;o in d?t(d[o]):l.ajax({url:__flex_g_settings.suggestions.service_url,dataType:"json",data:{term:e.term,board:__flex_g_settings.boardId},success:function(e){d[o]=e,t(e)}})}function u(e,t){var o=l("#flex_ac_rental_slug").val(),n="undefined"!=typeof IB_AGENT_PERMALINK?IB_AGENT_PERMALINK+"/search":__flex_g_settings.searchUrl,n=(n+="?for="+(0==o?"sale":"rent"))+(null!==t?"&keyword="+encodeURIComponent(e)+"_"+t.toLowerCase():"&keyword="+encodeURIComponent(e));window.location.href=n}function t(e,t){u(t.item.value,t.item.type),setTimeout(function(){document.activeElement.blur()},100)}function o(){}function n(){""===this.value&&(p.autocomplete("option","source",m),p.autocomplete("search",""))}function a(e){""!==this.value&&13===e.keyCode&&(p.autocomplete("close"),setTimeout(function(){document.activeElement.blur()},100)),p.autocomplete("option","source",i)}function c(e){if(40!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&37!=e.keyCode){var t=this.value;if(""!==t&&13===e.keyCode)if(p.autocomplete("close"),setTimeout(function(){document.activeElement.blur()},100),19==__flex_g_settings.boardId){for(var o=0,n=m.length;o<n;o++){var l=m[o];if(!1!==new RegExp("^"+l.label+"$","i").test(t)){a=l;break}}void 0!==a?u(a.label,"city"):u(t,null)}else if(/^\d+$/.test(t)&&5===t.length)u(t,"zip");else{for(var a,o=0,n=m.length;o<n;o++){l=m[o];if(!1!==new RegExp("^"+l.label+"$","i").test(t)){a=l;break}}void 0!==a?u(a.label,"city"):u(t,null)}""===t?(p.autocomplete("option","source",m),p.autocomplete("search","")):(p.autocomplete("option","source",i),p.autocomplete("search",p.val()))}}function s(){p.autocomplete("option","source",m),p.autocomplete("search","")}function r(){p.autocomplete("option","source",i)}var p,f,m=function(){var e=_.pluck(__flex_g_settings.params.cities,"name"),t=[];if(e.length)for(var o=0,n=e.length;o<n;o++)t.push({label:e[o],type:"city"});return t}(),d={};l(function(){p=l("#flex_idx_single_autocomplete_input"),(f=l("#flex_idx_single_autocomplete")).length&&f.on("submit",e),p.length&&(p.autocomplete({minLength:0,open:function(e,t){l(".ui-autocomplete").off("menufocus hover mouseover mouseenter")},create:function(e,t){},source:i,select:t,appendTo:"#ib-autocomplete-add"}),p.autocomplete("instance")._renderItem=function(e,t){return("complex"===t.type?l("<li>").append('<div title="'+t.label+'">'+t.label+'<span class="autocomplete-item-type">Complex / Subdivision</span></div>'):l("<li>").append('<div title="'+t.label+'">'+t.label+'<span class="autocomplete-item-type">'+t.type+"</span></div>")).appendTo(e)},p.on("focus",n),p.on("blur",o),p.on("keypress",a),p.on("keyup",c),p.on("search",s),p.on("paste",r))})}(jQuery);